<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="generator" content="HTML Tidy for HTML5 for Linux version 5.8.0">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="../assets/usage.css">
  <title>Resampling Filters -- ImageMagick Examples</title>
  <link rel="icon" href="../img_www/favicon.ico" type="image/x-icon">
  <link rel="shortcut" href="../img_www/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="https://imagemagick.org/Usage/filter/">
</head>
<body>
  <main class="container">
    <div class="magick-template">
      <div class="magick-header">
        <h1>ImageMagick Examples --<br>
        <img src="../img_www/space.gif" width="50" height="1"> Resampling Filters</h1>
        <div>
          <b>Index</b><br>
          <table cellspacing="0">
            <tr valign="top">
              <td colspan="2">
                <a href="../"><img src="../img_www/granitesm_left.gif" border="0" width="15" height="15"> ImageMagick Examples Preface and Index</a>
              </td>
            </tr>
            <tr valign="bottom">
              <td>
                <dl>
                  <dd>
                    <a href="#artifacts"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Resampling Artefacts</a> - How good is Resize?
                    <dl>
                      <dd><font size="-1"><a href="#blocking">Blocking</a>,&nbsp; <a href="#ringing">Ringing</a>,&nbsp; <a href="#aliasing">Aliasing</a>,&nbsp; <a href="#blurring">Blurring</a></font></dd>
                    </dl>
                    <ul>
                      <li>
                        <a href="#photoshop">ImageMagick Resize VS Photoshop Resize</a>
                      </li>
                    </ul>&nbsp;
                  </dd>
                  <dd>
                    <a href="#filter"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Resampling Filters</a>
                    <ul>
                      <li>
                        <a href="#interpolated">Interpolated Filters</a>
                        <dl>
                          <dd><font size="-1"><a href="#point">Point</a>,&nbsp; <a href="#box">Box</a>,&nbsp; <a href="#triangle">Triangle</a>,&nbsp;<br>
                          <a href="#interpolate_other">Other Interpolation Filters</a><br>
                          <a href="#hermite">Hermite</a>,&nbsp; <a href="#lagrange-i">Lagrange</a>,&nbsp; <a href="#catrom-i">Catrom</a></font></dd>
                        </dl>
                      </li>
                      <li>
                        <a href="#gaussian">Gaussian Blurring Filter</a>
                        <ul>
                          <li>
                            <a href="#gaussian">Gaussian</a>,&nbsp;
                          </li>
                          <li>
                            <a href="#sigma">Sigma Expert Control</a>
                          </li>
                          <li>
                            <a href="#gaussian_other">Other Gaussian-like Filters</a>
                            <dl>
                              <dd><font size="-1"><a href="#quadratic">Quadratic</a>,&nbsp; <a href="#spline">Spline</a></font></dd>
                            </dl>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <a href="#support">Filter Support Expert Control</a>
                      </li>
                      <li>
                        <a href="#blur">Filter Blur Expert Control</a>
                      </li>
                      <li>
                        <a href="#gaussian_interpolator">Gaussian Interpolator Filter</a>
                      </li>
                      <li>
                        <a href="#windowed">Windowed Sinc Filters</a>
                        <ul>
                          <li>
                            <a href="#window_how">How Windowing Filters Work</a>
                          </li>
                          <li>
                            <a href="#windowing">The Various Windowing Filters</a>
                            <dl>
                              <dd><font size="-1"><a href="#sinc">Sinc</a>,&nbsp; <a href="#hann">Hann</a>,&nbsp; <a href="#hamming">Hamming</a>,&nbsp; <a href="#blackman">Blackman</a>,&nbsp; <a href="#bohman">Bohman</a>,&nbsp;<br>
                              <a href="#kaiser">Kaiser</a>,&nbsp; <a href="#bartlett">Bartlett</a>,&nbsp; <a href="#parzen">Parzen</a>,&nbsp; <a href="#cosine">Cosine</a>,&nbsp; <a href="#welch">Welch</a></font></dd>
                            </dl>
                          </li>
                          <li>
                            <a href="#lanczos">Lanczos Filter</a>
                          </li>
                          <li>
                            <a href="#lobes">Windowing Support Size in Lobes</a>
                          </li>
                        </ul>
                      </li>
                    </ul>
                  </dd>
                </dl>
              </td>
              <td>
                <dl>
                  <dt><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Resampling Filters (Cont)</dt>
                  <dd>
                    <ul>
                      <li>
                        <a href="#lagrange">Lagrange Filter</a>
                      </li>
                      <li>
                        <a href="#cubics">Cubic Filters</a>
                        <dl>
                          <dd><font size="-1"><a href="#spline-c">Spline</a>,&nbsp; <a href="#catrom-c">Catrom</a>,&nbsp; <a href="#hermite-c">Hermite</a>,&nbsp; <a href="#mitchell">Mitchell</a></font></dd>
                        </dl>
                        <ul>
                          <li>
                            <a href="#cubic_bc">Cubic BC Settings</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <a href="#cylindrical">Cylindrical Filters</a> -- Filters for Distort
                        <ul>
                          <li>
                            <a href="#cyl_interpolated">Interpolated Cylindrical Filters</a>
                          </li>
                          <li>
                            <a href="#cyl_gaussian">Cylindrical Gaussian</a>
                          </li>
                          <li>
                            <a href="#jinc">Jinc Windowed Filters</a>
                          </li>
                          <li>
                            <a href="#distort_noop">Distort and the No-Op case</a>
                            <dl>
                              <dd><font size="-1"><a href="#lanczos_cylindrical">Cylindrical Lanczos</a>,&nbsp; <a href="#lanczos2">Lanczos2</a>,&nbsp;<br>
                              <a href="#lanczos_sharp">LanczosSharp</a>,&nbsp; <a href="#lanczos2sharp">Lanczos2Sharp</a>,&nbsp; <a href="#lanczos_radius">LanczosRadius</a>,&nbsp;<br>
                              <a href="#robidoux">Robidoux</a>,&nbsp; <a href="#robidoux_sharp">Robidoux Sharp</a> <a href="#robidoux_soft">Robidoux Soft</a></font></dd>
                            </dl>
                          </li>
                          <li>
                            <a href="#cyl_summary">Cylindrical Filters Summary</a>
                          </li>
                        </ul>
                      </li>
                      <li>
                        <a href="#options">Expert Filter Controls</a>
                      </li>
                      <li>
                        <a href="#summery">Summary of Resize filters</a>
                        <ul>
                          <li>
                            <a href="#compare">Filter Comparison</a>
                          </li>
                          <li>
                            <a href="#best_filter">Best Filter</a>?
                          </li>
                          <li>
                            <a href="#default_filter">IM's Default Filter</a>
                          </li>
                        </ul>
                      </li>
                    </ul>&nbsp;
                  </dd>
                  <dt>
                    <a href="nicolas/"><img src="../img_www/granitesm_right.gif" border="0" width="15" height="15"> Resampling by Nicolas Robidoux</a> (sub-section)
                  </dt>
                </dl>
              </td>
            </tr>
          </table>Here we get in to the lower level aspects of Resize and Distortion of images, looking at the resampling filters that is used to determine the final color of each individual pixel in the resulting image. This is extensive, long studied, and often full of opinion and personal views rather than any hard qualitive facts, as it is imposible to determine what constitutes a perfect resize image. This is a proven fact, and makes for a very large area of study that will never be finished. It is recommended you read and understand the <a href="../resize/">Resize and Scaling Operators</a>.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="artifacts" id="artifacts"></a>
          <h2>Resampling Artefacts <font size="-1">- How good is IM Resize</font></h2>Image resizing has to combat a very difficult problem. How do you reduce an array of values, into a smaller, or larger array of values so that it look good to our eyes. A lot of things can go wrong while attempting to do this, but they fall into four basic categories.. <a name="blocking" id="blocking"></a>
          <h3>Blocking</h3>Essentially, if you enlarge an image simply by replicating pixels, you will create larger rectangular blocks of pixels. In fact magnifying images using either "<code><a href="../option_link.cgi?scale">-scale</a></code>" or "<code><a href="../option_link.cgi?sample">-sample</a></code>" does exactly that, producing an enlarged pixelated image. For example, here I scale a small image, generating large blocks of color rather that a nice smooth image. Next to that is a 'resized' version, and finally one using a Gaussian filter to blur it more than normal and replace isolated pixels with round dots, to remove some of the blockiness.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick storm.gif  -scale  300%  storm_scaled.gif
  magick storm.gif  -resize 300%  storm_resized.gif
  magick storm.gif -filter Gaussian -resize 300%  storm_resized_gas.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="center">
                <td align="center">
                  <a href="../images/storm.gif"><img src="../images/storm.gif" width="32" height="32" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Original
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"></td>
                <td align="center">
                  <a href="storm_scaled.gif"><img src="storm_scaled.gif" width="96" height="96" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Scaled
                </td>
                <td align="center">
                  <a href="storm_resized.gif"><img src="storm_resized.gif" width="96" height="96" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Resized
                </td>
                <td align="center">
                  <a href="storm_resized_gas.gif"><img src="storm_resized_gas.gif" width="96" height="96" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Gaussian Resized
                </td>
              </tr>
            </table>
          </div>The primary cause of 'blocking' is either badly anti-aliased source image, or not enough smoothing (color mixing or blurring) between pixels to improve the overall look of an image. It is also typically seen when a very low resolution image is being resized to a much larger scale or for use on a high resolution device. The most common place this is seen is in the use of a bitmap image in user generated newsletters and magazines that were then printed on very high resolution laser printers. The newsletter looks great on screen, but comes out 'blocky' on the printed page. This situation is very hard to fix, and generally best avoided, by using a much higher resolution clipart, or using a scalable vector image (such as SVG, and WMF format images). Of course in some situations, blocking artifacts is actually desirable, and enhanced in the results. For example when you are trying to recreate some old low-resolution video games on newer high resolution displays, keeping the old 'blockiness' of the image enhances the 'retro' look. Or perhaps when you are trying to rotate images, without generating and new, or merged colors. Techniques for actually preserving the 'blockiness', but filling in the squares with diagonal lines, is known as <a href="http://www.wikipedia.org/wiki/Pixel_art_scaling_algorithms">Pixel Art Scaling Algorithms</a>, and many such schemes have been developed. On scheme has been built into ImageMagick, with the <a href="../resize/#magnify">Magnify</a> operator.<a name="ringing" id="ringing"></a>
          <h3>Ringing</h3>Ringing is an effect you often see in very low quality JPEG images close to sharp edges. It is typically caused by an edge being over compensated for by the resize or image compression algorithm, or a high quality filter being used with a bad support size. Here for example I use a special option to select a raw Sinc filter, on an very sharp color change. I also repeated the operation using IM's default resize operator, with its default filter selection for image enlargements.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -size 8x16 xc:'#444' xc:'#AAA' +append  gray_edge.gif
  magick gray_edge.gif -filter Sinc \
                         -resize 100x100\!  gray_edge_ringing.gif
  magick gray_edge.gif  -resize 100x100\!  gray_edge_resize.gif
</samp></pre>
                </td>
              </tr>
            </table><a href="gray_edge.gif"><img src="gray_edge.gif" width="16" height="16" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a> <img src="../img_www/right.gif" width="20" height="20" align="middle" alt="==&gt;"> <a href="gray_edge_ringing.gif"><img src="gray_edge_ringing.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a> <a href="gray_edge_resize.gif"><img src="gray_edge_resize.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a>
          </div>The above shows quite clearly the over compensation produced by the use of a raw resize filter, without any of the optimization IM provides. The second image, produced by the default IM enlargement filter also shows a very slight ringing effect, but it is barely noticeable, and actually desirable in that it perceptually sharpens the border. Here is another example of the ringing effect, this time by enlarging a single pixel, on a gray background.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -size 1x1 xc: -bordercolor '#444' -border 4x4 \
          -define filter:lobes=5  -filter Sinc \
          -resize 100x100\!   dot_sinc.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="dot_sinc.gif"><img src="dot_sinc.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This image also clearly shows the secondary effects generated by the use of an one dimensional filter. That is, the ringing effect is strongest in horizontal, and vertical (orthogonal) direction, with 45 degree secondary ringing. And this time with a cylindrical filter (via the <a href="../distorts/#resize">Distort Resize Operation</a>), showing how it differs from the more normal 2 pass orthogonally aligned (tensor) filter which the <a href="../resize/#resize">Resize Operator</a> uses.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick -size 1x1 xc: -bordercolor '#444' -border 4x4 \
          -define filter:lobes=5  -filter Jinc \
          -distort resize 100x100\! +repage dot_jinc.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="dot_jinc.gif"><img src="dot_jinc.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>These effects are not normally visible, and only seen here because of the use of the use of a raw '<code>Sinc</code>' or '<code>Jinc</code>' filter (see <a href="#windowed">Windowed Filters</a> below) for some extreme enlargements. Typically a 'raw' filter like this is not used. <a name="aliasing" id="aliasing"></a>
          <h3>Aliasing and Moiré Effects</h3>Aliasing effects are generally seen as the production of 'staircase' like effects along edges of images. Often this is caused either by raw sampling of the image such as using "<code><a href="../option_link.cgi?sample">-sample</a></code>", or overly sharpening of the image during resizing. A staircasing effect is most noticeable in strong minification of images, though is rarely seen in IM. However, aliasing also has other effects, in particular large scale Moiré patterns appearing in images containing some type of pixel level pattern. These low level patterns often produce large scale Moiré patterns, including: patterns of parallel lines, cloth weaves (silk exhibits this effect in real life!), as well as brick and tile patterns in photos of brick buildings, fences, and paving. <a href="../img_photos/rings_sm_orig.gif"><img src="../img_photos/rings_sm_orig.gif" width="200" height="200" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> For some examples of resized images producing strong Moiré effects see the <a href="http://en.wikipedia.org/wiki/Moir%C3%A9_pattern">Wikipedia, Moiré Pattern</a> Page. The classic way of checking if a resize will produce aliasing problems, is by minifying a <a href="../img_photos/rings_sm_orig.gif">Rings Image</a> (see right). This image will often show Moiré effects when any form of resize is applied at any scale. Web browsers in particular show such Moiré effects when displaying such an image due to the use of an ultra fast (but often poor) resizing technique.<br clear="all">
          Here I show the 'rings' image resized using the strongly aliasing "<code><a href="../option_link.cgi?sample">-sample</a></code>" operator, the block averaging "<code><a href="../option_link.cgi?scale">-scale</a></code>" operator and the normal default "<code><a href="../option_link.cgi?resize">-resize</a></code>".
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick rings_sm_orig.gif  -sample 100x100  rings_sample.png
  magick rings_sm_orig.gif  -scale  100x100  rings_scale.png
  magick rings_sm_orig.gif  -resize 100x100  rings_resize.png
</samp></pre>
                </td>
              </tr>
            </table>
            <table width="90%">
              <tr>
                <td align="center">
                  <a href="rings_sample.png"><img src="rings_sample.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  sample
                </td>
                <td align="center">
                  <a href="rings_scale.png"><img src="rings_scale.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  scale
                </td>
                <td align="center">
                  <a href="rings_resize.png"><img src="rings_resize.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  resize
                </td>
              </tr>
            </table>
          </div>As you can see all the resize methods did produce some Moiré effects, though IM's default resize operator produces the least amount of this undesirable secondary patterns in the final image. To show the effects of only a slight resize, I cropped the corner from the <a href="../img_photos/rings_lg_orig.png">Large Rings Image</a>, the result of which is shown first, and then reduced its size by just 5%.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick rings_lg_orig.png -crop 105x105+0+0  rings_crop.png
  magick rings_crop.png    -sample 100x100    rings_crop_sample.png
  magick rings_crop.png    -scale  100x100    rings_crop_scale.png
  magick rings_crop.png    -resize 100x100    rings_crop_resize.png
</samp></pre>
                </td>
              </tr>
            </table>
            <table width="90%">
              <tr valign="top">
                <td align="center">
                  <a href="rings_crop.png"><img src="rings_crop.png" width="105" height="105" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  cropped original
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="40" alt="==&gt;"></td>
                <td align="center">
                  <a href="rings_crop_sample.png"><img src="rings_crop_sample.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  sample
                </td>
                <td align="center">
                  <a href="rings_crop_scale.png"><img src="rings_crop_scale.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  scale
                </td>
                <td align="center">
                  <a href="rings_crop_resize.png"><img src="rings_crop_resize.png" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  resize
                </td>
              </tr>
            </table>
          </div>As you can see even a slight resize will show up any aliasing a resize operator may have. In fact if you look closely you may even seen a very light Moiré effect in the original unscaled crop of the original starting image, which is produced from the limitations of only using a raster image at a density suitable for display on a computer screen. That is, how sensitive this test image is in showing aliasing effects caused by shrinking images. <a name="blurring" id="blurring"></a>
          <h3>Blurring</h3>Most people are familiar with blurring that can be generated by the use of "<code><a href="../option_link.cgi?resize">-resize</a></code>". In fact this is probably the number one complaint about any resize image, and with good reason. Usually a very small resize will tend to produce a blurred image, and resizing it again will only make it worse. The problem is that when you resize an image you are changing the image stored as a 'grid' or array of pixels (known as a 'raster') to fit a completely different 'grid' of pixels. The two 'grids' will not match except in very special cases, and as a result, the image data has to be modified to make it fit this new pattern of dots. Basically it is impossible to directly resize an image and expect it to come out nicely, though a reasonable result can be achieved. The result is an usually a slight blurring of the pixel data. The better the resize algorithm, the less blurring of sharp edges there is. However some resize filters, especially ones designed specifically for enlarging images, often add a lot more blurring than necessary. This is to combat '<a href="#blocking">Blocking</a>' artifacts as demonstrated above. For image minification a blurred edge is often used to avoid '<a href="#ringing">Ringing</a>' artifacts at sharp edges and reduce possible <a href="#aliasing">Aliasing</a> effects. This however is a poor man's compromise and one that IM tries hard to avoid. Even so, a special expert <a href="../filter/#blur">Filter Blur</a> setting can be used to adjust the blurring that a filter provides. However be warned that while a number smaller than 1.0 is supposed to reduce blurring, it can also make it worse, depending on the exact filter and the resize ratios that are being used. No guarantees can be given.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.3.6-3 the <a href="../filter/#blur">Filter Blur</a> setting was called "<code><a href="../option_link.cgi?support">-support</a></code>", which was very misleading in exactly what it did. This option has been depreciated and is no longer available.</i></font></td>
            </tr>
          </table>The better method of fixing bluring effects cause by resize is to re-filter the image using a sharpening operator. See <a href="../resize/#resize_unsharp">Sharpen Resized Images</a> for more details. <a name="photoshop" id="photoshop"></a>
          <h3>IM Resize vs other Programs</h3>A practical comparison of IM's default resize operator to a number of other programs in resizing a real-world image has been provided by, Bart van der Wolf at...
          <div align="center">
            <a href="http://www.bvdwolf.nl/foto/resample/example1.html">Down-sampling Example</a>
          </div>Specifically, in summary for IM resize...
          <blockquote>
            <b><i>Although the amount of sharpening is a matter of taste, the lack of aliasing artifacts produces the cleanest, most natural looking image of them all.</i></b>
          </blockquote>He also goes on to look at a 'rings' test, to directly compare various Photoshop resize methods against ImageMagick...
          <div align="center">
            <a href="http://www.bvdwolf.nl/foto/resample/down_sample.html">Down-sampling Methods</a>
          </div>These articles shows just how important doing resize correctly (and using the right filtering methods) is to image processing. We look this at more closely in the next section.<br>
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="filter" id="filter"></a>
          <h2>Resampling Filters</h2>The "<code><a href="../option_link.cgi?filter">-filter</a></code>" setting is the key control on how "<code><a href="../resize/#resize">Image Resizing</a></code>" as well as "<code><a href="../distorts/#distort">General Distort Operator</a></code>", works to produce a clean result with the minimum of <a href="#artifacts">Resampling Artefacts</a>. This has been a topic of intense study during the late 1980's, and from which <a href="http://www.cs.cmu.edu/~ph/">Paul Heckbert</a>, a major researcher in this field, produced and publicly released his "<code><font size="+1"><b><a href="http://www.xmission.com/~legalize/zoom.html">zoom</a></b></font></code>" image resizing program. This program became the father of most image resizing programs used today, though many later programs implement it poorly, as it is easy to get it wrong. For example have a look at the results of testing <a href="http://entropymine.com/resamplescope/notes/browsers/">How web browsers resize images</a>. In many ways, these filters are closely related to <a href="../convolve/#intro">Convolving Images</a>, and even the <a href="../convolve/#blur">Blurring Kernel</a>. They even suffer from the similar problems. However filters are designed to improve the look of the final result when resizing, or otherwise distorting an image. The names of the filters are a veritable "who's who" of image processing experts and mathematicians of the past century (or more). They are usually not a description of the filter, but just a label of the person who either first published the filter (or filter family), or did the most research into that filter. This however makes it much harder to know whether a '<code>Lagrange</code>' filter (named after Joseph-Louis Lagrange) is better than, say, a '<code>Catrom</code>' filter (named after Edwin Catmull and Raphael Rom). Here I will explain the major aspects of Filters. It is not vital that you learn these things, but I decided to document a summary of what I learnt, after completing research in this area, as part of a major overhaul and expansion of the IM resize filter system, (IM 6.3.7-1). Special thanks goes to <a href="http://www.fmwconcepts.com/fmw/fmw.html">Fred Weinhaus</a> for his help in the research during the re-development of the Resize Filters. He was especially eager for the addition of the '<code><a href="#lagrange">Lagrange</a></code>' family of filters, which did not exist in IM resize before this overhaul. Also thanks goes to <a href="http://ca.linkedin.com/pub/nicolas-robidoux/40/3ab/b73">Nicolas Robidoux</a>, who's mathematics helped solve a major fault in the <a href="../distorts/#distort">General Distort Operator</a>, and then develop <a href="#cylindrical">Cylindrical Filters</a>, that produce better results that what you get with the <a href="../resize/#resize">Resize Operator</a>.
          <h3>How filters work</h3>When resizing an image you are basically trying to determine the correct value of each pixel in the new image, based on the pixels in the original source image. However these new pixels do not match exactly to the positions of the old pixels, and so a correct value for these pixels needs to be determined in some way. What is done is to try to use some type of weighted average of the original source pixel values to determine a good value for the new pixel. The real pixels surrounding the location of the new pixel forms a 'neighbourhood' of contributing values. The larger this neighbourhood is the slower the resize. This is a technique called <a href="../convolve/#intro">Convolution</a>. The amount each real neighbouring pixel (known as a 'sample') contributes to produce the final pixel is determined by a weighting function. This is the '<i>filter</i>' that you can select using the "<code><a href="../option_link.cgi?filter">-filter</a></code>" setting. That filter in turn generally has an ideal neighbourhood size, which is known as the filter's '<i>support</i>', though it is also known as its '<i>window</i>'. A pre-defined two dimensional '<i>filter</i>' is also known as a '<i>convolution kernel</i>'.
          <pre><i>FUTURE: some diagrams may be helpful here</i></pre>The design of these weighting functions, or 'filters' is a very complex business involving some complex mathematics, frequency analysis, and even Fourier Transforms. A good starting point if you are interested in this is <a href="http://en.wikipedia.org/wiki/Nyquist-Shannon_sampling_theorem#Application_to_multivariable_signals_and_images">Wikipedia: Nyquist–Shannon sampling theorem</a>. However, you really don't need to go that far to understand existing filters and their effects on images.
          <h3>The Filters</h3><a name="interpolated" id="interpolated"></a>
          <h3>Interpolated Filters</h3>The simplest type of resize filter functions are <b>Interpolative</b> methods. These take a specific pixel location in the source image and try to simply determine a logical color value of the image at that location based on the colors of the surrounding pixels. As there is only ever a fixed and minimal number of pixels involved, this type of filter is a very fast method of resizing or otherwise distorting images. However, this is also the filter's downfall, as it will not merge a larger number of pixels together to form an image that is greatly smaller than the original image. That in turn can result in strong <a href="#aliasing">Aliasing and Moiré Effects</a>. Interpolation is usually only used for 'point' sampling images, when image scaling is either not known or needed. For example, when rotating image or minor distortions, the image's scaling or size does not change, and as such an interpolation can produce a reasonable result, though not a very accurate one. For more information see IM's <a href="../misc/#interpolate">Interpolation Setting</a>. It is not however suitable for general image resizing. <a name="point" id="point"></a>
          <h4>Point</h4>Using a "<code><a href="../option_link.cgi?filter">-filter</a></code>" setting of '<code><b>Point</b></code>' basically means to use an unscaled interpolation filter. For the <a href="../resize/#resize">Resize Operator</a>, it will just select the closest pixel to the new pixels position, and that is all. This means that the <a href="../resize/#resize">Resize Operator</a> will simply use the color of an actual pixel in the source image will be used. No attempt will be made to merge colors or generate a better color for the resulting image. As a result using "<code>-filter point -resize ...</code>" will produce the same result as "<code><a href="../option_link.cgi?sample">-sample</a></code>" (see <a href="../resize/#sample">Sampling Operator</a>), though the latter is faster as it code is specifically designed to resizing images by point sampling, with controls to tune the exact sampling point.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>For the <a href="../distorts/#distort">Distort Operator</a> selecting "<code><a href="../option_link.cgi?filter">-filter</a> Point</code>", will force the use of <a href="../misc/#interpolate">Interpolated Point Sampling</a> instead of a <a href="#cylindrical">Cylindrical Filter</a>. See <a href="../distorts/#distort_filter">Image Filters in the Distort Operator</a> for more detail.<br>
              <br>
              If you desire the same <a href="../misc/#interpolate">Interpolated Point Sampling</a> for normal image resize you can use the <a href="../resize/#interpolative-resize">Interpolative Resize</a> operator instead. Or use point filtered <a href="../distorts/#resize">Distort Resize</a> for the same result.<br>
              <br></i></font></td>
            </tr>
          </table>Here I start with a 10x10 pixel hash pattern and reduce it in size, before scaling so that you can see the result.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -size 10x10 pattern:gray50  checks_10.gif
  magick checks_10.gif -filter point -resize 9x9  checks_point-1.gif
  magick checks_10.gif -filter point -resize 8x8  checks_point-2.gif
  magick checks_10.gif -filter point -resize 7x7  checks_point-3.gif
  magick checks_10.gif -filter point -resize 6x6  checks_point-4.gif
  magick checks_10.gif -filter point -resize 5x5  checks_point-5.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="checks_10.gif"><img src="checks_10_mag.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  &nbsp;
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="50" alt="==&gt;"></td>
                <td align="center">
                  <a href="checks_point-1.gif"><img src="checks_point-1_mag.gif" width="90" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Point-1
                </td>
                <td align="center">
                  <a href="checks_point-2.gif"><img src="checks_point-2_mag.gif" width="80" height="80" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Point-2
                </td>
                <td align="center">
                  <a href="checks_point-3.gif"><img src="checks_point-3_mag.gif" width="70" height="70" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Point-3
                </td>
                <td align="center">
                  <a href="checks_point-4.gif"><img src="checks_point-4_mag.gif" width="60" height="60" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Point-4
                </td>
                <td align="center">
                  <a href="checks_point-5.gif"><img src="checks_point-5_mag.gif" width="50" height="50" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Point 50%
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE SCRIPT>
  magick checks_10.gif -scale 1000% checks_10_mag.gif
  magick checks_point-1.gif -scale 1000% checks_point-1_mag.gif
  magick checks_point-2.gif -scale 1000% checks_point-2_mag.gif
  magick checks_point-3.gif -scale 1000% checks_point-3_mag.gif
  magick checks_point-4.gif -scale 1000% checks_point-4_mag.gif
  magick checks_point-5.gif -scale 1000% checks_point-5_mag.gif
</CODE> -->
          All that is really happening is that single rows and columns of pixels are removed across the image. Even at this level, you will get extreme <a href="#blocking">blocking</a> and <a href="#aliasing">aliasing</a> in the resulting image, and can in specific cases like the above produce a completely unrealistic result. As such, a '<code>Point</code>' filter, or the faster equivelent <a href="#sample">Sampling Operator</a>, is not recommended for normal image resizing. <a name="box" id="box"></a>
          <h4>Box</h4>The '<code><b>Box</b></code>' filter setting is exactly the same as '<code>point</code>' with one slight variation. When shrinking images it will average, and merge the pixels together. The smaller the resulting image the more pixels will be averaged together. <a href="graph_filter_box.jpg"><img src="graph_filter_box.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> Here is a graph of the filter's weighting function, from which you can see why it is called a '<code>Box</code>' filter. Basically any pixel that falls inside the 'Box' will be directly used to calculate the color of the new pixel. Now as the filter is only 1/2 a pixel wide, and that means for an image that is not actually being resized, only one pixel the closest pixel, will be used. In other words when no scaling is involved (or only magnification) the nearest pixel to the new location will form the color of the new pixel. However if an image is being made smaller, more of the source image will be compressed into the bounds of that 'box'. The result is that more pixels will be averaged together to produce the color for the pixel in the smaller image. For example, here is an enlarged view of a checkerboard pixel pattern as it is being slowly compressed using a '<code>Box</code>' filter.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick checks_10.gif -filter box -resize 9x9  checks_box-1.gif
  magick checks_10.gif -filter box -resize 8x8  checks_box-2.gif
  magick checks_10.gif -filter box -resize 7x7  checks_box-3.gif
  magick checks_10.gif -filter box -resize 6x6  checks_box-4.gif
  magick checks_10.gif -filter box -resize 5x5  checks_box-5.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="checks_10.gif"><img src="checks_10_mag.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  &nbsp;
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="50" alt="==&gt;"></td>
                <td align="center">
                  <a href="checks_box-1.gif"><img src="checks_box-1_mag.gif" width="90" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box-1
                </td>
                <td align="center">
                  <a href="checks_box-2.gif"><img src="checks_box-2_mag.gif" width="80" height="80" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box-2
                </td>
                <td align="center">
                  <a href="checks_box-3.gif"><img src="checks_box-3_mag.gif" width="70" height="70" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box-3
                </td>
                <td align="center">
                  <a href="checks_box-4.gif"><img src="checks_box-4_mag.gif" width="60" height="60" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box-4
                </td>
                <td align="center">
                  <a href="checks_box-5.gif"><img src="checks_box-5_mag.gif" width="50" height="50" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box 50%
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE SCRIPT>
  magick checks_box-1.gif -scale 1000% checks_box-1_mag.gif
  magick checks_box-2.gif -scale 1000% checks_box-2_mag.gif
  magick checks_box-3.gif -scale 1000% checks_box-3_mag.gif
  magick checks_box-4.gif -scale 1000% checks_box-4_mag.gif
  magick checks_box-5.gif -scale 1000% checks_box-5_mag.gif
</CODE> -->
          As you can see, more and more pixels become merged together as the image is resized smaller using a '<code>Box</code>' filter, but that the merger occurs in specific, equally spaced, rows and columns. This causes all sorts of artifacts and Moiré or <a href="#aliasing">Aliasing</a> effects when both shrinking images and enlarging. It is recommended that '<code>Box</code>' filtering be used for 'binning' images. That is, reducing images by integer multiples to ensure that every pixel in the result is an average of the same number of neighbouring pixels (the 'bin'). The resulting image will thus remain clean looking, just as in the final image above. It is also recommended that much faster the <a href="../resize/#scale">Scale Operator</a> is used instead of the 'Box Filter'. It will produce almost identical results, except in a special case of reducing images by just a few pixels. When 'binning' it will produce identical results.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The <a href="../resize/#scale">Scale Operator</a> is not exactly the same as a 'Box Filter', as it is implemented using a special 'Pixel Mixing' algorithm. For exact details see <a href="../resize/#pixel_mixing">Scale Internals</a>.</i></font></td>
            </tr>
          </table>When enlarging both '<code>Point</code>' and '<code>Box</code>' filters will produce the same 'pixel replication' of rows and columns, as they all result in using a simple 'nearest-neighbour' selection.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -size 5x5 pattern:gray50  checks_5.gif
  magick checks_5.gif -filter box   -resize 6x6    checks_box+1.gif
  magick checks_5.gif -filter box   -resize 7x7    checks_box+2.gif
  magick checks_5.gif -filter box   -resize 8x8    checks_box+3.gif
  magick checks_5.gif -filter box   -resize 9x9    checks_box+4.gif
  magick checks_5.gif -filter box   -resize 10x10  checks_box+5.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="checks_5.gif"><img src="checks_5_mag.gif" width="50" height="50" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  &nbsp;
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="50" alt="==&gt;"></td>
                <td align="center">
                  <a href="checks_box+1.gif"><img src="checks_box+1_mag.gif" width="60" height="60" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box+1
                </td>
                <td align="center">
                  <a href="checks_box+2.gif"><img src="checks_box+2_mag.gif" width="70" height="70" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box+2
                </td>
                <td align="center">
                  <a href="checks_box+3.gif"><img src="checks_box+3_mag.gif" width="80" height="80" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box+3
                </td>
                <td align="center">
                  <a href="checks_box+4.gif"><img src="checks_box+4_mag.gif" width="90" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box+4
                </td>
                <td align="center">
                  <a href="checks_box+5.gif"><img src="checks_box+5_mag.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Box+5
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE SCRIPT>
  magick checks_5.gif -scale 1000% checks_5_mag.gif
  magick checks_box+1.gif -scale 1000% checks_box+1_mag.gif
  magick checks_box+2.gif -scale 1000% checks_box+2_mag.gif
  magick checks_box+3.gif -scale 1000% checks_box+3_mag.gif
  magick checks_box+4.gif -scale 1000% checks_box+4_mag.gif
  magick checks_box+5.gif -scale 1000% checks_box+5_mag.gif
</CODE> -->
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The <a href="../resize/#scale">Scale Operator</a> also produces similar results, but with some pixel color mixing, when enlarging, unless enlarging by an integer scaling factor.</i></font></td>
            </tr>
          </table><a name="triangle" id="triangle"></a>
          <h4>Triangle</h4><a href="graph_filter_triangle.jpg"><img src="graph_filter_triangle.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The '<b>Triangle</b>' or '<code><a href="../misc/#bilinear">Bilinear</a></code>' interpolation filter just takes the interpolation of the nearest neighbourhood one step further. Instead of just directly averaging the nearby pixels together, as '<code>Box</code>' does, it weights them according to how close the new pixels position is to the the original pixels within the neighbourhood (or '<i>support</i>' region). The closer the new pixel is to a source image pixel, the more color that pixel contributes. This produces a more global averaging of colors when images are being reduced in size.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick checks_10.gif -filter triangle -resize 9x9 checks_tri-1.gif
  magick checks_10.gif -filter triangle -resize 8x8 checks_tri-2.gif
  magick checks_10.gif -filter triangle -resize 7x7 checks_tri-3.gif
  magick checks_10.gif -filter triangle -resize 6x6 checks_tri-4.gif
  magick checks_10.gif -filter triangle -resize 5x5 checks_tri-5.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="checks_10.gif"><img src="checks_10_mag.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  &nbsp;
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="50" alt="==&gt;"></td>
                <td align="center">
                  <a href="checks_tri-1.gif"><img src="checks_tri-1_mag.gif" width="90" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri-1
                </td>
                <td align="center">
                  <a href="checks_tri-2.gif"><img src="checks_tri-2_mag.gif" width="80" height="80" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri-2
                </td>
                <td align="center">
                  <a href="checks_tri-3.gif"><img src="checks_tri-3_mag.gif" width="70" height="70" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri-3
                </td>
                <td align="center">
                  <a href="checks_tri-4.gif"><img src="checks_tri-4_mag.gif" width="60" height="60" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri-4
                </td>
                <td align="center">
                  <a href="checks_tri-5.gif"><img src="checks_tri-5_mag.gif" width="50" height="50" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE SCRIPT>
  magick checks_tri-1.gif -scale 1000% checks_tri-1_mag.gif
  magick checks_tri-2.gif -scale 1000% checks_tri-2_mag.gif
  magick checks_tri-3.gif -scale 1000% checks_tri-3_mag.gif
  magick checks_tri-4.gif -scale 1000% checks_tri-4_mag.gif
  magick checks_tri-5.gif -scale 1000% checks_tri-5_mag.gif
</CODE> -->
          As you can see as the corner pixels were near perfect matches to the corners of the original image they are more visible, but toward the middle where none of the nearby pixels exactly match up with the new pixel being generated, you get a more average color of the whole neighbourhood. The result for the checkerboard pixel pattern is a tendancy to fade in and out of an average gray color. However as the '<i>support</i> neighbourhood is larger, more pixels will be involved when you enlarge the image. Thus producing averaging of colors when generating the pixels being added to the image.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick checks_5.gif -filter triangle -resize 6x6  checks_tri+1.gif
  magick checks_5.gif -filter triangle -resize 7x7  checks_tri+2.gif
  magick checks_5.gif -filter triangle -resize 8x8  checks_tri+3.gif
  magick checks_5.gif -filter triangle -resize 9x9  checks_tri+4.gif
  magick checks_5.gif -filter triangle -resize 10x10 checks_tri+5.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="checks_5.gif"><img src="checks_5_mag.gif" width="50" height="50" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  &nbsp;
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="50" alt="==&gt;"></td>
                <td align="center">
                  <a href="checks_tri+1.gif"><img src="checks_tri+1_mag.gif" width="60" height="60" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri+1
                </td>
                <td align="center">
                  <a href="checks_tri+2.gif"><img src="checks_tri+2_mag.gif" width="70" height="70" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri+2
                </td>
                <td align="center">
                  <a href="checks_tri+3.gif"><img src="checks_tri+3_mag.gif" width="80" height="80" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri+3
                </td>
                <td align="center">
                  <a href="checks_tri+4.gif"><img src="checks_tri+4_mag.gif" width="90" height="90" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri+4
                </td>
                <td align="center">
                  <a href="checks_tri+5.gif"><img src="checks_tri+5_mag.gif" width="100" height="100" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Tri+5
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE SCRIPT>
  magick checks_tri+1.gif -scale 1000% checks_tri+1_mag.gif
  magick checks_tri+2.gif -scale 1000% checks_tri+2_mag.gif
  magick checks_tri+3.gif -scale 1000% checks_tri+3_mag.gif
  magick checks_tri+4.gif -scale 1000% checks_tri+4_mag.gif
  magick checks_tri+5.gif -scale 1000% checks_tri+5_mag.gif
</CODE> -->
          For large scale enlargements the result acts as if a gradient of colors was added between each and every pixel. For example, here I generate a very small image with a single white pixel (the display is an enlarged view). I then enlarge that image enormously.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick xc: -bordercolor black -border 2x0 pixel_5.gif
  magick pixel_5.gif  -filter triangle -resize 300x  pixel_triangle.gif
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center">
                  <a href="pixel_5.gif"><img src="pixel_5_mag.gif" width="100" height="20" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Single Pixel Image<br>
                  (magnified)
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="35" alt="==&gt;"></td>
                <td align="center">
                  <a href="pixel_triangle.gif"><img src="pixel_triangle.gif" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Triangle Filter Enlarged
                </td>
              </tr>
            </table>
          </div><!-- <CODE EXECUTE>
  magick pixel_5.gif        -scale 2000% pixel_5_mag.gif
</CODE> -->
          If you were to graph the colors in the above image (using the "<code><a href="../scripts/im_profile">im_profile</a></code>" script), you will see a replica of the triangular filter graph. <!--<CODE EXECUTE>
  im_profile pixel_triangle.gif plot_triangle.gif
</CODE>-->
          <div align="center">
            <img src="plot_triangle.gif" align="middle" vspace="5" hspace="5" border="0" alt="[IM Profile]"><br>
            Profile of Image
          </div>As you can see the central pixel was merged with the neighbouring pixels to produce a linear gradient of colors between those points. All the interpolation filters, produce similar gradient patterns between neighbouring pixels and is also the reason why they are so well suited to image enlargements. <a name="hermite" id="hermite"></a> <a name="hermite-i" id="hermite-i"></a> <a name="interpolate_other" id="interpolate_other"></a>
          <h4>Other Interpolation Filters</h4><a href="graph_interpolation.jpg"><img src="graph_interpolation.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> To the right I have graphed the various interpolation filters, except for '<code>Point</code>' which is actually very special case of an unscaled '<code>Box</code>' filter (a pure '<code><a href="../misc/#nearest">NearestNeighbor</a></code>' interpolation). Other interpolation filters include '<code><b>Hermite</b></code>' which is very similar to triangle in results, but producing a smoother round off for enlargements, that smooths gradient transitions. Click on the <a href="graph_lagrange_interpolate.jpg">graph on the right</a> to see a graph of these three filter functions.<br clear="all">
          <a name="lagrange-i" id="lagrange-i"></a> <a href="graph_lagrange_interpolate.jpg"><img src="graph_lagrange_interpolate.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The '<code><b>Lagrange</b></code>' filter has been called a 'universal' interpolation filter. By varying the 'support' size (See the <a href="#support">Support Expert Setting</a> below), it can generate all the previously looked at interpolation filters (except '<code>Hermite</code>'). The default settings (a Lagrange order 3 filter (support=2.0) as shown as the purple line on the graph right) provides a reasonable 'cubic' filter. It works very well though the gradient change can result in some noticeable <a href="#blocking">blocking</a> effects on enlargement, though with bitmap images and line drawings this can be a good thing. More on the other <a href="#lagrange">Lagrange Filter</a> orders later. <a href="graph_filter_catrom.jpg"><img src="graph_filter_catrom.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> <a name="catrom" id="catrom"></a> <a name="catrom-i" id="catrom-i"></a> The '<code><b>Catrom</b></code>' (Catmull-Rom) filter is a well known standard <a href="#cubics">Cubic Filter</a> often used as an interpolation function, and is available under the same name. This filter produces a reasonably sharp edge, but without a the pronounced gradient change on large scale image enlargements that a '<code>Lagrange</code>' filter can produce. It is basically equivelent to a built-in 'unsharp resize' (see <a href="../resize/#resize_unsharp">Sharpened Resized Images</a>), though some consider it far too sharp, and does not provide any control of the sharpening. What does make a '<code>Catrom</code>' filter more interesting is that it is almost an identical cubic equivelent of a 2-lobe '<code><a href="#lanczos">Lanczos</a></code>' filter, which is probably the most commonly used <a href="#windowed">Windowed-Sinc Filter</a> (see below). We will also look at this filter more closely later in <a href="#cubics">Cubic Filters</a>.
          <h4>Interpolation and IM's Interpolate Setting</h4>The <a href="../misc/#interpolate">Interpolate</a> setting of IM which is used to produce an unscaled 'point' lookup of images in operators like the <a href="../transform/#fx">FX DIY Operator</a> ("<code><a href="../option_link.cgi?fx">-fx</a></code>") and <a href="../color_mods/#clut">Color Lookup Replacement Operator</a> ("<code><a href="../option_link.cgi?clut">-clut</a></code>"), and some older <a href="../warping/#circular">Circular Distortion</a> functions are based on these simple interpolation resize filters. However they are currently implemented using separate code and also have different setting names. These <a href="../misc/#interpolate">Interpolation Settings</a> include: '<code><a href="../misc/#nearestneighbor">NearestNeighbor</a></code>', implementing the '<code>Point</code>' (or unscaled '<code>Box</code>') filter, and '<code><a href="../misc/#bilinear">BiLinear</a></code>' to get an unscaled '<code>Triangle</code>' filter. <i>ASIDE: At this time the smoothed triangle filter '<code>Hermite</code>' has not been directly implemented as an <a href="../misc/#interpolate">Interpolation Setting</a>, which is a shame as it is quite a good interpolation filter.</i>
          <p><a name="gaussian" id="gaussian"></a></p>
          <h3>Gaussian Blurring Filters</h3>In the complex mathematics of Fourier Transforms into frequency domains, resize filters are meant to remove any high frequency noise that may be present. This noise is caused by the sampling of a real world image into pixels, and when you resize an image, that noise appears as aliasing and Moiré effects. Because of this the Gaussian Bell Curve became a natural early candidate as a resizing or resample filter, as it is the ideal model for real world effects.
          <h4>Gaussian</h4><a href="graph_filter_gaussian.jpg"><img src="graph_filter_gaussian.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The <b>Gaussian</b> filter is a very special filter that generates that same 'bell curve' shape in the frequency domain. This makes it very useful as an image filter as it guarantees a good removal of this high frequency noise in a highly controllable way. However if you examine the filter graph, you will see that at a distance of one pixel from the sampling point, you have a non-zero value. In fact it is quite a high value indeed. This results in a huge amount of blurring of the individual pixels, even when no resize is actually performed. For example, here I have resized the standard IM logo using a Gaussian filter and again using the normal IM filter ('<code>Lanczos</code>' in this case, which we will look at later)
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick logo:  -filter Gaussian  -resize 150x logo_gaussian.png
  magick logo:                    -resize 150x logo_normal.png
</samp></pre>
                </td>
              </tr>
            </table>
            <table>
              <tr valign="bottom">
                <td align="center"></td>
                <td align="center">
                  <a href="logo_gaussian.png"><img src="logo_gaussian.png" align="middle" vspace="5" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Gaussian
                </td>
                <td align="center">
                  <a href="logo_normal.png"><img src="logo_normal.png" align="middle" vspace="5" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Normal Resize
                </td>
              </tr>
            </table>
          </div>If you look closely you will see that the left '<code>Gaussian</code>' filtered image is more blurry than the normal resize. Especially with regard to the detail of the smaller stars around the wand and on the wizard's hat. This blurring of the image is the trade off you get for removing all the <a href="#aliasing">aliasing</a> effects in image reduction, as well as all <a href="#blocking">blocking</a> effects on image enlargement. It will also, never produce any <a href="#ringing">ringing</a> effects (when applied perfectly). But all that is at the cost of extreme <a href="#blurring">blurring</a> for the resulting image.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                In fact, during large scale enlargements, this filter will generate round dots, rather than square looking dots. For example, here I greatly enlarge a 3x3 pixel image with a single dot in the center.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick xc:red -bordercolor yellow -border 1 \
          -filter Gaussian   -resize 99x99  -normalize dot_gaussian.jpg
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="dot_gaussian.jpg"><img src="dot_gaussian.jpg" width="99" height="99" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>As you can see a single pixel enlarges into perfectly circular dot. Only Gaussian and Gaussian-like filters will do this. <a name="sigma" id="sigma"></a>
          <h4>Gaussian Sigma Expert Control</h4>You can control the Gaussian Filter directly using an a special expert option "<code><a href="../option_link.cgi?define">-define</a> filter:sigma=<i>{value}</i></code>" to specify the actual 'sigma' value of the Gaussian curve. By default this value is '<code>0.5</code>' which is also the same size as the <a href="#box">Box Filter</a>. In many ways you can regard a Gaussian Filter as essentially a 'blurred box'. This expert option was added to allow for the creation of very very small Gaussian Blurs, without reducing the <a href="#support">Filter's Support</a> range (see below). However increasing the 'sigma' could cause the filter to become clipped. As such when increasing the 'sigma' value the default 'support' (<code>2.0</code>) is also increased by a similar amount. This only happens on increases in the default 'sigma' value. The <a href="#support">Support Expert Setting</a> can be used to override this automatic effect, but it is typically not necessary.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The '<code>filter:sigma</code>' expert option only works for the <a href="#gaussian">Gaussian Filter</a>. No other filters are effected by this expert control.<br>
              <br>
              A more generalised control, for other filters can be achievd using <a href="#blur">Blur Filter Expert Control</a> which we will look at later.<br>
              <br></i></font></td>
            </tr>
          </table><a name="spline" id="spline"></a> <a name="quadratic" id="quadratic"></a> <a name="gaussian_other" id="gaussian_other"></a>
          <h4>Other Gaussian-like Filters</h4><a href="graph_gaussian.jpg"><img src="graph_gaussian.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> If you study the comparative graphs to the right you will see that '<b><code>Quadratic</code></b>' filter as well as the slightly more complex '<b><code>Spline</code></b>' filter follow the weighting curve of the '<code>Gaussian</code>' filter quite well. And being polynomial functions they are also a lot faster to calculate, which was why they were originally invented. While '<code>Quadratic</code>' is very slightly more blurry than the <a href="#gaussian">Gaussian Filter</a>, the '<code>Spline</code>' filter is even more blurry, with an equivelent <a href="#sigma">Sigma</a> setting of approximatally '<code>0.65</code>'. This makes a '<code>Spline</code>' filter the most blurry filter provided without modifications. Examining the graphs you will see that like the <a href="#gaussian">Gaussian Filter</a> and unlike <a href="#interpolate_other">Interpolation Filters</a> they have a non-zero value at a distance of 1.0 from the sampling point. This causes the nearby pixels to merge their colors, and is the cause of the blurring you see. The '<code>Spline</code>' filter having the highest value at the 1.0 distance producing the largest amount of blurring in any resized (or distorted) image. This extra blurriness removes the last of any 'blocking' effects that may be present in large scale enlargements. And could be used with a <a href="../resize/#resize_unsharp">Sharpen Resized Images</a> technique to enlarge line drawing with very little 'staircase effects' in the results. The '<b><code><a href="#mitchell">Mitchell</a></code></b>' filter is also shown in the comparison graph. This filter also has a some blurring at the 1.0 distance from the sampling point, which also makes this filter slightly blurry, much like the other filters we have seen. However it also has some negative weighting in its curve, which while producing <a href="#ringing">ringing</a> effects (see <a href="#windowed">Window Sinc Filters</a> later), offsets that bluriness near sharp edges. <a name="support" id="support"></a>
          <h3>Filter Support Expert Control</h3>The Gaussian filter is known as an IIR (Infinite Impulse Response) filter, which simply means that the response 'curve' it uses never reaches zero. That is, no matter how far away from the sampling point you get, you will still have some non-zero contribution to the result from very distant pixels. In mathematical terms this is actually a good thing, as it means the result is much more mathematically perfect. In practical application it is very bad, as an infinite filter requires you to use a weighted average of every pixel in the original image, to generate each and every new pixel in the destination image. That means that large images would take a very very long time to resize perfectly using this filter. However for the '<code>Gaussian</code>' filter anything beyond a range of about 2 pixels (4 times its default 'sigma' setting) from the sampling point will generally produce very little effect in terms of the final result, and as such can be generally be ignored. Even 3 times the sigma is generally regarded as reasonable. This range is known as the filter's '<i>support window</i>' and is the program's practical limit for the filter. If you really want, you can change the 'support' of a filter using the special expert setting "<code><a href="../option_link.cgi?define">-define</a> filter:support=<i>{value}</i></code>".
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                For example, here I resize an image with a single pixel using the smaller support value of 1.25, or 2-1/2 times the sigma value.(see the <a href="graph_gaussian_support.jpg">resulting graph</a> right). This is of course smaller that the normal generally accepted minimum of 3 times the sigma value.
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
<br>  magick pattern:gray5 -crop 5x1+0+3 +repage pixel_5.gif
  magick pixel_5.gif  -filter gaussian -define filter:support=1.25 \
          -resize 300x  pixel_gaussian.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="graph_gaussian_support.jpg"><img src="graph_gaussian_support.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <div align="center">
            <!--<CODE EXECUTE>
  im_profile pixel_gaussian.png plot_gaussian.gif
</CODE>-->
            <table>
              <tr>
                <td align="center">
                  <a href="pixel_5.gif"><img src="pixel_5.gif" width="100" height="20" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Single Pixel Image
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="25" alt="==&gt;"></td>
                <td align="center">
                  <a href="pixel_gaussian.png"><img src="pixel_gaussian.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  Gaussian Filtered
                </td>
              </tr>
            </table><img src="plot_gaussian.gif" align="middle" vspace="5" hspace="5" border="0" alt="[IM Profile]"><br>
            Profile of Image
          </div>By using the smaller '<code>support</code>' setting, the 'step' (where the support window cuts off the function) was moved to the 1.25 position. That in turn, results in a larger 'stop' in the filter's profile, and results in an 'aliasing' effects that you can see in the enlargement. That is, the wiggle near the 'peak' of the graph, as well as a sudden 'drop' at the edges of the filter's 'support' limits. You can think of 'support' as being a sliding 'window' across the pixels being averaged together to produce the enlarged image result. As the support size is 1.25, the filter's total support area is 2.5 pixels wide (unscaled during image enlargements), as such you can have either 2 or 3 pixels involved in the horizontal resizing phase. As this support 'window' slides across the image, each pixel entering or leaving will generate the sudden 'change' in the filters 'curve'. That is, the cause of the slight jiggles in the results. That is, at these points, a pixel is being added or removed from the total number of pixels being averaged together according to the filter weighting curve. This in turn produces four such 'jiggles' or 'zig-zags' in the resized image, An initial two on the outside edges when the single white pixel enters/leaves the support range, and a second pair of jiggles as a second black pixel (making a three pixel weighted average) enters/leaves the support range. If there wasn't such a sudden 'stop' in the filter, that is, the filter goes to zero at the support limit setting, then you would not see the 'jiggles' and you would not have the visible effect. Using a support size set to an integer or half-integer (such as the default 'support' setting for a '<code>Gaussian</code>' filter of '2.0') would always ensure that whenever a new pixel enters the support range, another pixel is leaving, so that the same number of pixels is always part of that average. That would remove the two 'center' jiggles, but it will not not remove the initial jiggles on the outside, marking the support limits. Even sharp slope changes (discontinuities) in the filter, such as you get from a <a href="#triangle">Triangle</a>, or a <a href="#lagrange">Lagrange</a> filter can generate visible artifacts in the resulting image.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Previous to IM v6.3.6-3 the 'support' for the Gaussian filter was set to this value of '<code>1.25</code>' producing <a href="#ringing">Ringing</a> effects in enlargements (such as shown above). For this reason the 'support' for Gaussian was changed to '<code>1.5</code>' ensure the same number of pixels were always being averaged, and to reduce the smaller step.<br>
              <br>
              As of IM v6.6.5-0 the default 'support' setting for Gaussian was increased to a value of '<code>2.0</code>'. This has little effect on the overall speed of the filter, but makes the 'stop' practically non-existent. It also simplified filter coding for other special uses of this filter, specifically for <a href="../distorts/#area_resample">EWA distortions</a>, and <a href="../mapping/#blur">Variable Blur Mapping</a>.<br>
              <br></i></font></td>
            </tr>
          </table>Note however that if you use a very large support setting then of course more pixels will need to be averaged together making the resize operation slower, without any real improvement in results. Only the <a href="#windowed">Windowed Sinc/Jinc</a> and <a href="#lagrange">Lagrange</a> filters can generally produce a better result by using a support window that is larger than 2.0. Remember these are 'expert' options, and as such you are more likely to make things worse rather than better by using these options. That is, why they are not a simple command line option, but provided via the special "<code><a href="../option_link.cgi?define">-define</a></code>" option. Of course you are welcome to play, just as I have done above, so as to try and understand things better, and IM provides these options so that you can do just that. <a name="blur" id="blur"></a>
          <h3>Filter Blur Expert Control</h3>A special expert option, "<code><a href="../option_link.cgi?define">-define</a> filter:blur=<i>{value}</i></code>" can be used to adjust amount of blurring that a filter provides. A value of '<code>1.0</code>' producing the default action, while smaller and larger values adjust overall 'blurriness'. Basically this linearly enlarges or shrinks the filter's curve along the X axis (distance of pixel form the sampling point), and typically make a filter more or less blurry, overall. Using a smaller setting results in the filter's function (and its support window) becoming smaller. For <a href="#gaussian">Gaussian</a> and <a href="#gaussian_other">Gaussian-like</a> filters the effect is as if you multiplied the filters 'sigma' value (default=0.5) by this 'blur' factor. This setting will also enlarge or shrink the filters <a href="#support">Support Window</a> by the same amount so as to prevent clipping, but this can be overridden using the <a href="#support">Support Expert Filter Setting</a>. For example, here I resize an image with three different 'blur' settings, using a <a href="#spline">Gaussian-like Spline Filter</a>..
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" script="" image="logo_blur_1.0.png">
  for blur in 0.5 1.0 1.5; do \
    magick logo: -define filter:blur=$blur -filter Spline \
            -resize 150x logo_blur_$blur.png; \
  done
</code></pre>
                </td>
              </tr>
            </table>
            <table cellspacing="0" cellpadding="0">
              <tr valign="top">
                <td align="center">
                  <a href="logo_blur_0.5.png"><img src="logo_blur_0.5.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  blur 0.5
                </td>
                <td align="center"><img src="../img_www/left.gif" width="20" height="20" vspace="40" alt="&lt;=="></td>
                <td align="center">
                  <a href="logo_blur_1.0.png"><img src="logo_blur_1.0.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  blur 1.0
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="40" alt="==&gt;"></td>
                <td align="center">
                  <a href="logo_blur_1.5.png"><img src="logo_blur_1.5.png" align="middle" vspace="5" hspace="5" border="1" alt="[IM Output]"></a><br>
                  blur 1.5
                </td>
              </tr>
            </table>
          </div>As you can see, this special setting will let you control the overall blurriness of the result for '<code>Spline</code>' filter. As the size of the 'support window' is also scaled by the <a href="#blur">Filter Blur</a> setting, using very small scaling values can cause the resampling to 'miss' all pixels, or generate only zero weighted pixels. As a result regular 'black' lines or blocks will be generated. For example...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick rose: -define filter:blur=0.1 -filter Gaussian \
          -resize 100x100  rose_black_bars.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="rose_black_bars.png"><img src="rose_black_bars.png" width="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>Increasing the size of the support window (before it is scales by blur), may help prevent these effects, but as most filters will only produce zero weightings for pixels that fall outside their 'natural' support range, it will not work for all filters. The only filters that will typically generate useful non-zero values over the whole support range is the <a href="#box">Box Filter</a> and the <a href="#windowed">Sinc/Jinc Windowed Filters</a>. Similar effects can be seen with <a href="#cyl_interpolated">Cylindrical Filters</a>, when the filters support becomes too small to always find at least one pixel to sample. The <a href="#lagrange">Lagrange Filters</a> uses <a href="#blur">Support Expert Filter Setting</a> to determine the appropriate 'order' to fit into the 'support window', and thus polymorphs into various other forms (see below).
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Using bad support settings with filters containing negative weightings (basically any of the filters we will look at next) can produce inverse sharpening and negation effects, and disproportionately stronger aliasing effects. In rare cases it can even generate infinite weighted colors (which get clamped to pure black and white in normal non_HDRI versions of IM).<br>
              <br>
              Caution and expertise is recommended when using this special option with any filter.</i></font></td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.3.6-3 the '<code>filter:blur</code>' define was mistakenly set by the option "<code>-support</code>", which was very misleading in exactly what it did. This option has been depreciated, and no longer available.</i></font></td>
            </tr>
          </table><a name="gaussian_interpolator" id="gaussian_interpolator"></a>
          <h3>Gaussian Interpolator Filter Variant</h3><a href="graph_blurred.jpg"><img src="graph_blurred.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> A <a href="#blur">Blur Control</a> value of '<code>0.75</code>' on <a href="#gaussian_other">Gaussian-like Filters</a>, or using a <a href="#sigma">Sigma Control</a> value of '<code>0.375</code>' for the <a href="#gaussian">Gaussian Filter</a> will generate a variation I call a <b>Gaussian Interpolator</b>. This sharpened Gaussian filter as similar proprieties as the <a href="#interpolate_other">Interpolation Filters</a> we looked at above. But does not contain any sharp stops, or other gradient changes that can be noticeable in enlarged images. In this respect it is much like the "<code><a href="#hermite">Hermite</a></code>" filter (see graph), but with non-symmetrical skew that does seem to work better as an interpolator.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" noimage="">
  magick logo: -filter Gaussian -resize 150x logo_gaussian.png
  magick logo: -define filter:blur=0.75 -filter Gaussian \
          -resize 150x logo_gaussian_interpolate.png
</code></pre>
                </td>
              </tr>
            </table>
            <table cellspacing="0" cellpadding="0">
              <tr valign="top">
                <td align="center">
                  <a href="logo_blur_1.0.png"><img src="logo_blur_1.5.png" align="middle" vspace="5" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Gaussian
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="40" alt="==&gt;"></td>
                <td align="center">
                  <a href="logo_gaussian_interpolate.png"><img src="logo_gaussian_interpolate.png" align="middle" vspace="5" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Gaussian Interpolator<br>
                  <font size="-1">(blur=0.75 or sigma=0.375)</font>
                </td>
              </tr>
            </table>
          </div>In fact I find it makes the Gaussian filter produce much more acceptable results, which is not too sharp, and not to blurry. However reducing the <a href="#blurring">blurring</a> of the filter will enhance the <a href="#aliasing">aliasing</a> effects, thus more likely to generate large scale Moiré effects from low pixel level patterns. This is the trade off of using a less blurry form of the filter.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" noimage="">
  magick rings_crop.png -filter gaussian -resize 100x100  rings_gaussian.png
  magick rings_crop.png -filter gaussian -define filter:blur=0.75 \
                              -resize 100x100  rings_gaussian_interpolate.png
</code></pre>
                </td>
              </tr>
            </table>
            <table cellspacing="0" cellpadding="0">
              <tr valign="top">
                <td align="center">
                  <a href="rings_gaussian.png"><img src="rings_gaussian.png" width="100" height="100" align="middle" vspace="5" hspace="30" border="1" alt="[IM Output]"></a><br>
                  Gaussian
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="40" alt="==&gt;"></td>
                <td align="center">
                  <a href="rings_gaussian_interpolate.png"><img src="rings_gaussian_interpolate.png" width="100" height="100" align="middle" vspace="5" hspace="30" border="1" alt="[IM Output]"></a><br>
                  Gaussian Interpolator<br>
                  <font size="-1">(blur=0.75 or sigma=0.375)</font>
                </td>
              </tr>
            </table>
          </div><a name="windowed" id="windowed"></a>
          <h3>Windowed Sinc Filters</h3><a name="sinc" id="sinc"></a>
          <h4>Sinc Filters</h4>Mathematics has determined that the ideal filter for resizing image (using a 2-pass 'tensor' resize technique) is the the <i>Sinc()</i> function. (See <a href="http://en.wikipedia.org/wiki/Nyquist-Shannon_sampling_theorem#Application_+to_multivariable_signals_and_images">Nyquist-Shannon sampling theorem</a>). <a href="graph_sinc.jpg"><img src="graph_sinc.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The <i>Sinc()</i> being mathematically perfect has some special features that I would like to point out. First at every integer distance from the weighting function for the filter becomes zero. This is very important as it means that the filter does not blur the image more than necessary (unlike <a href="#gaussian">Gaussian Filters</a>). It also means if an image is resampled without resizing (a "no-op" resize) the image remains completely unaffected by the filter. It is thus an interpolative filter though a very complex one. The <i>Jinc()</i> function is closely related to <i>Sinc()</i>, and has proprieties that make it useful as a filter for 2-dimensional filtering, such as used by the <a href="../distorts/#distort">General Image Distortion Operator</a>. More about this function later in <a href="#cylindrical">Cylindrical Filters</a>. For now just note that it could also be used as the base function for <a href="#jinc">Windowed Jinc Filters</a>. The other major difference between <i>Sinc()</i> and <i>Jinc()</i> based filters and previous filters we have looked at is that many of the weights are negative. That is, they will subtract some of the nearby color pixels from the final color, for each pixel in the image. This may seem a little strange, but it results in a strong sharpening of the edges of objects. Of course any negative weights generally need to be offset by lots more positive weights further along the curve, which produces the wave like function you see extending out a long range from the sampling point. These extra 'lobes' of positive (and negative) weights causes <a href="#ringing">ringing</a> artifacts in images which contain very strong color boundaries, such as in high contrast line drawings, or boundary such as a red roof to a blue sky. These ringing effects can become even more pronounced if filters based on these functions is applied improperly.
          <h4>Windowing Functions</h4>Unfortunately this function is also IIR (Infinite Impulse Response) function, That is, to say it has effects going all the way to infinities, just like the <a href="#gaussian">Gaussian Filter</a> previously. This means that to use 'Sinc', you would need to generate a weighted average of every pixel in the image (and beyond) in order to create the best representation for each and every new pixel in the destination image. This is prohibitively expensive, making the direct use of these perfect filters impractical. Not that you would want to due to ringing effects. But unlike the <a href="#gaussian">Gaussian Filter</a>, the 'Sinc' function does not just taper down to near zero a short distance from the sample point. In fact, even at 10 pixels away from the sampling point (see graph above), you can get an appreciable effect on the final result. However resizing an image using a filter that has a support distance of 10 would require an averaging of at least 20x20 or 400 pixels per pixel in the final result. And that would produce a very slow resize. As a consequence, using a raw form "<code>Sinc</code>" filter not recommended, and almost never used, though by using <a href="#options">Expert Filter Controls</a> IM will not prevent you from doing this, if that is what you really want to do. What is recommended and provided are 'windowed' forms of the Sinc function, which have been developed by image processing experts, that can be used to 'limit' the infinite Sinc (and Jinc) functions to a more practical size. These <i>Windowing Filters</i> include filters such as; '<code>Blackman</code>', '<code>Bohman</code>', '<code>Hann</code>', '<code>Hamming</code>' '<code>Lanczos</code>', '<code>Kaiser</code>', '<code>Welch</code>', '<code>Bartlett</code>', and '<code>Parzen</code>'. <a name="window_how" id="window_how"></a>
          <h4>How Windowed Filters Work</h4><a href="graph_sinc_windowing.jpg"><img src="graph_sinc_windowing.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> For example, the graph to the right shows three functions (click to get an enlarged view). The red function is the mathematically ideal <i>Sinc()</i> function, which stretches off to infinity. The green function is a "Hann" windowing function (based on a simple Cosine() curve . This is multiplied with the <i>Sinc()</i> to modulate the more distant components of the filter, reaching zero (or near zero) at the edge of the support window (4.0 pixel units is distance by default for this filter). Basically by selecting '<code>Hann</code>' for the "<code><a href="../option_link.cgi?filter">-filter</a></code>" selection you are in reality selecting the '<i>Hann()</i>' '<i>Windowing Function</i>' to modulate the '<i>Weighting function</i>' such as '<i>Sinc()</i>' (or '<i>Jinc()</i>'). As such, '<i>Windowed Filters</i>' are really two functions. Either the Sinc or the Jinc function (depending on the image processing operator), and the 'Windowing Function' you have specifically selected as the filter to use. (See <a href="#options">Expert Filter Controls</a> below).
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before v6.3.6-3, IM made the grave mistake of actually using the windowing functions directly as the filter's weighting function. This in turn caused all these filters (except Lanczos) to produce badly <a href="#aliasing">aliased</a> images, when used for resizing. As a consequence the filters were often mis-understood or rarely used by IM users. This has now been fixed.</i></font></td>
            </tr>
          </table><a name="windowing" id="windowing"></a> <a name="welch" id="welch"></a> <a name="cosine" id="cosine"></a> <a name="bartlett" id="bartlett"></a> <a name="hamming" id="hamming"></a> <a name="hann" id="hann"></a><a name="hanning" id="hanning"></a> <a name="kaiser" id="kaiser"></a> <a name="blackman" id="blackman"></a> <a name="bohman" id="bohman"></a> <a name="parzen" id="parzen"></a>
          <h4>The Various Windowing Filters</h4><a href="graph_windowing.jpg"><img src="graph_windowing.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> To the right is a graph of all the various windowing functions that IM has available at the time of writing (more was added later). Yes, there are a lot of them, as windowing functions have been the subject of intense study by numerous signal processing experts. All of the windowed filter functions will generally be used to modulate a Sinc (or Jinc) weighting function using a support of either 3, or 4 for Sinc (3 or 4 lobes), depending on the class of windowing function being used (see below). For example a '<code>Blackman</code>' windowing filter will use 4 lobes, but '<code>Lanzcos</code>' will use 3 lobes. This is dependant on your IM version, so check the <a href="#options">Verbose Filter Expert Option</a> if you want to be sure. As you can see all the windowed filtered functions produce a muted form of the original <i>Sinc()</i> function that is also shown. And other than the amount of <a href="#ringing">ringing</a> a specific filter generates there is often very little to distinguish one windowed filter from another. Probably one of the best windowed filters is '<b><code>Lanczos</code></b>'. While other people swear by the '<b><code>Blackman</code></b>', '<b><code>Bohman</code></b>', '<b><code>Hann</code></b>' (a cosine tappered bell), '<b><code>Hamming</code></b>' (cosine bell variant), '<b><code>Cosine</code></b>' (single cosine lobe); as windowing functions. All these functions are based on the use of a Sinc, or a Sine/Cosine functions in their formulation, which supposedly ensures the function will have a good frequency response. The other windowing filters include '<b><code>Welch</code></b>' (parabolic), '<b><code>Parzen</code></b>' (cubic spline), '<b><code>Kaiser</code></b>' (Bessel), and probably simplest '<b><code>Bartlett</code></b>' (triangular or linear). Typically these functions were created for their simplicity and speedy calculation, though they are typically regarded as having a poor 'frequency response'. Also many of these windowing functions are used as resampling filters in their own right. For example the '<code>Bartlett</code>' (which is probably the real odd ball of all the windowing functions) is actually the same mathematical function used for a '<code>Triangle</code>' filter, as well as the '<code>Bilinear</code>' interpolation filter. All the functions (except '<code>Bartlett</code>') form two basic categories of windowing functions.
          <ul>
            <li>A tapering 'bell' shaped curve, such as '<code>Hamming</code>', '<code>Hann</code>', '<code>Kaiser</code>', '<code>Blackman</code>', '<code>Bohman</code>', and '<code>Parzen</code>'.</li>
            <li>And an untappered 'lobe' type windowing function which quickly falls to zero, before being 'cut off' by the windows support, such as '<code>Lanczos</code>', '<code>Welch</code>', and '<code>Cosine</code>'.</li>
          </ul>If you study the above window function graph you can see how the shapes of the two styles of filter differ. However the two categories of windowing functions do not seem to be as important as the overall 'frequency response' you get from using a trigonometric defined curve. The tappering 'bell' shaped windowing functions will use a <a href="#lobes">Lobes Support</a> over 4 lobes of the Sinc Weighting function (or Jinc function in cylindrical (distort) resampling). The untappering 'lobe' type of windowing filters will default to using a 3 lobe support. This results in a rough equivalence between the two types of windowing filter, due to difference in the windowing function roll off. This also means that the untappering windowed filters will, by default, be slightly faster that the tappering ones. The default number of lobes that filters should have was discussed in the IM Forums Discussion, <a href="../forum_link.cgi?f=22&amp;t=20942">Add Cosine windowing?</a>. Of course if you want you can change the <a href="#lobes">Lobes Support</a> or even just the general support of any of the resize filters. They are all about the same only with very slight variations in the amount of ringing and blocking effects that is produced. <a href="graph_windowing_support.jpg"><img src="graph_windowing_support.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> To the right is the same windowing functions but using the default <a href="#lobes">Lobes Support</a> as defined by IM according to the tappered/untappered nature of the function. As you can see over the first two lobes (the primary ones with the most influence) there is very little difference between any of the filters, and all show a very similar 'roll-off' over that range. However the ordering of the functions have not changed much, with the extremes still being between '<b><code>Welch</code></b>' and '<b><code>Parzen</code></b>', and with '<b><code>Lanczos</code></b>' falling squarely in the middle of the resulting curve roll-offs. <a href="graph_windowed_sinc.jpg"><img src="graph_windowed_sinc.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> And to the right is the resulting windowed-sinc filters that would be provided by an user selecting those windowing functions using the above defaults. As you can see the final weighting curves are all very similar, and as expected all are sandwiched between the extremes of '<b><code>Welch</code></b>' and '<b><code>Parzen</code></b>'. You can look at more detailed definitions and graphs of most of these various windowing functions, and their results in the Fourier Frequency Spectrum on <a href="http://en.wikipedia.org/wiki/Window_function">Wikipedia, Window function</a>.<br>
          <b>In summery:</b> I have not found a great deal of difference in results between these various windowing functions. Also my reading of research papers of results all seemed to be more of a qualitative opinion of their suitability, rather than anything concrete. My feeling is that just about any windowing function can be used, but if I was to pick one you are better sticking to the most popular '<code>Lanczos</code>' windowing filter. It is in the middle of all the above filters, has good frequency spectrum response, and is generally a good choice as a resampling filter. On the other hand an image processing expert, who has been instrumental in ImageMagick's Resampling filters, disagrees with this. Though he selects filters based more on the exact requirements for specific images. You can see his suggestions and comments in <a href="nicolas/">Techniques Recommended by Nicolas Robidoux</a>. <a name="lanczos" id="lanczos"></a>
          <h3>Lanczos Filter</h3>We have mentioned the '<b><code>Lanczos</code></b>' filter a number of times already. It is probably the most well known of the <a href="#windowed">Windowed Filters</a>, which falls in the middle of the range of windowed filters we have seen. Essentially it does not 'roll-off' too fast, or to slow, and has a good frequency response in the resulting fourier transform. Basically '<b><code>Lanczos</code></b>' makes a great starting point for any sort of filter work, and has been used extensivally in the recent development of <a href="#jinc">Windowed Jinc Cylindrical Filters</a> (see below). The '<b><code>Lanczos</code></b>' filter basically uses the first 'lobe' of the <i>Sinc()</i> function, to window the <i>Sinc()</i> function. That is, the filter's weighting function is used to set the filter's own windowing function. Many people see this as being a good reason to select it over the many other Windowed Sinc Filters. Though there is little to no real evidence that it is the best, it is a solid middle range filter. By default IM defines the '<code>Lanczos</code>' filter as having 3 'lobes'. The reason for this is because the windowing function itself is 'untappered', in that it is just a single lobe that cuts off, with the functions first zero crossing coinciding with the window support limits. See <a href="#window_how">How Windowed Filters Work</a> above. <a href="graph_lanczos_filters.jpg"><img src="graph_lanczos_filters.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> However a 2-lobed '<b><code>Lanczos2</code></b>' filter (Lanczos with a default lobes of 2, added for easy user selection) has also been found to be popular, as it will avoid the positive <a href="#ringing">Ringing Artefacts</a> that can be generated by Windowed-Sinc filters. The '<code>Catrom</code>' (actually the 'Catmull-Rom Filter'), is almost an exact duplicate of the '<code>Lanczos2</code>' filter though as it is a <a href="#cubics">Cubic Filter</a> it is much faster to generate mathematically. That however is typically not a problem with the way IM caches filter values before processing images. Having said this, a long <a href="../forum_link.cgi?t=20992&amp;p=85257">Discussion in the IM forums</a> seems to indicate that for orthogonal (tensor) resizing, a 4 lobe '<code>Lanczos</code>' actually works better for shrinking images, while preventing <a href="#aliasing">Moiré</a> in images of objects with very fine patterns, but at the cost of more <a href="#ringing">Ringing</a>. <a name="lobes" id="lobes"></a>
          <h3>Windowing Size in Lobes</h3>As I mentioned, the underlying Sinc (and Jinc) filter function is actually infinite in size. Though by default IM limits them using the specified windowing funtion to a much smaller, more practical size. However there may be some situations where you really want to try and get a much better, more exact resizing of the image using a much larger, and slower window (support) size. That can even be done quite simply using the <a href="#support">Filter Support</a> expert control, just as we did for <a href="#gaussian">Gaussian-like</a> filters. The windowing function itself will (in most cases) reduce the Sinc (and Jinc) to zero over the <a href="#support">support</a> setting range. But as the windowing function is scaled to fit the 'support' window, the resulting filter function will also change. <a href="graph_lanczos_lobes.jpg"><img src="graph_lanczos_lobes.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> For example, to the right I have graphed the '<code>Lanczos</code>' windowed filters, against the <i>Sinc()</i> function as a reference, using various 'support' settings from 2 to 8. Note that the actual size of the filter is limited by the actual support size used. The smaller the 'support' the faster the filter, but the less exactly the function follows the mathematically ideal <i>Sinc()</i> function. Look closely at each of the graphed curves. The 'green' (support=2) curve only has the main central peak, plus one negative 'lobe' (Equivelent to a '<code>Lanczos2</code>' filter). After this the function is just zero, and not used. The next 'purple' (support=3, and the default '<code>Lanczos</code>' filter) curve, has a much larger first negative 'lobe', then a smaller positive 'lobe'. This continues on with more lobes being added, as the support size increases by integer increments. The additional lobes are smaller and smaller in height, producing less and less influence on the final result, but with the initial 'lobes' becoming higher (more influence, and hence more <a href="#ringing">Ringing</a> effects). For best effect you would use a support setting, to generate a filter with that many up/down 'lobes' in it. That is, you would have the windowing function, and thus the 'support' of the filter, end at a 'zero-crossing'. However while the <i>Sinc()</i> function has 'lobe' (zero-crossings) at integer 'support' settings, the <i>Jinc()</i> weighting function does not. This presents a problem for users wanting to adjust the support window for a filter being used with the <a href="../distort../distorts//#distort">Distort Operator</a>. In fact, <i>Jinc()</i> has 'zero crossings' at highly <a href="http://en.wikipedia.org/wiki/Irrational_number">irrational numbered</a> positions. These zero crossings are very difficult to work out without being a mathematics expert. To make it easier to set a filter in terms of the number of 'lobes' another special setting was created, "<code><a href="../option_link.cgi?define">-define</a> filter:lobes=<i>{integer}</i></code>". If the filter is being used by a 2 dimensional image resampling operator such as the <a href="../distorts/#distort">General Distortion Operator</a>, which generally the use of <i>Jinc()</i> as the base function, it will look up a table of the first 20 zero crossings for the filter, and set the '<a href="#support">support</a>' setting to that value. This means you don't have to try to find the appropriate support setting for the <i>Jinc()</i> function, just specify the number of lobes you want to use. Because of this it is better to specify Windowed Sinc or Jinc filters in terms of the number of 'lobes' you want the filter to contain, rather than specifying a more direct '<a href="#support">support</a>' setting. If neither <i>Sinc()</i> or <i>Jinc()</i> functions are used for the filter definition, then the the '<code>filter:lobes</code>' setting is used to calculate the appropriate '<a href="#support">support</a>' setting for the filters usage. Note however that a '<code>filter:support</code>' setting will override any '<code>filter:lobes</code>' setting given, so it is better to only define the '<code>filter:lobes</code>' expert option, especially if using the <a href="../distorts/#distort">General Distortion Operator</a>. <a name="lagrange" id="lagrange"></a>
          <h3>Lagrange Filter</h3>Just as the '<code><a href="#gaussian">Gaussian</a></code>' filter is a mathematically slow function (not that it affects the overall speed very much thanks to IM's caching of results), the <a href="#windowed">Sinc/Jinc Windowed Filters</a> are even slower and more complex to compute due to the need to compute trigonometric functions for use in both weighting and windowing functions. The '<b><code>Lagrange</code></b>' filter however generates a piece-wise cubic polynomial function to approximate a windowed filter. (See <a href="http://en.wikipedia.org/wiki/Lagrange_polynomial">Wikipedia: Lagrange Polynomial</a>). Just as <a href="#windowed">Windowed Filters</a> are adjustable according to the <a href="#support">Support Setting</a>, the '<code>Lagrange</code>' filter also will adjust itself according to that setting. The default <a href="#support">support</a> setting of 2.0 generates a '<code>Lagrange</code>' filter (order 3). This filter is quite good for both enlargement and shrinking of images. with minimal <a href="#blocking">blocking</a> and <a href="#ringing">ringing</a> effects and no <a href="#blurring">blurring</a> effects.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The <a href="#support">Support Expert Control</a> is really defining the 'order' of the Lagrange filter that should be used. That is, the default 2.0 support Lagrange filter, generates a Lagrange filter of order 3 (order = support × 2 - 1, thus support=2.0 =&gt; Lagrange-3 filter). This is why you can really only use a setting in half-integer sizes.<br>
              <br>
              As such, to get a Lagrange order 4 filter you would use the option</i> &nbsp; <code>-define filter:support=2.5</code></font></td>
            </tr>
          </table><a href="graph_lagrange_windowed.jpg"><img src="graph_lagrange_windowed.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> With larger <a href="#support">support</a> settings, the '<code>Lagrange</code>' filter generates <a href="#windowed">Windowed Sinc Filters</a> without needing a complex trigonometric function calculation, or even additional windowing functions. The larger the support setting the closer the filter emulates a <i>Sinc()</i> function, but also the slower the calculation. (see graph of larger support Lagrange filters left).<br clear="all">
          <a href="graph_lagrange_interpolate.jpg"><img src="graph_lagrange_interpolate.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> Using smaller <a href="#support">support</a> settings and the '<code>Lagrange</code>' filter emulates most of the various <a href="#interpolated">Interpolated Filters</a>. That is, a support size of '<code>0.5</code>' will generate the '<code>Box</code>' filter, and '<code>1.0</code>' a '<code>Triangle</code>' filter. The <a href="#support">support</a> setting is limited to adjustments by half-integers, and using any other support factor is not very productive.<br clear="all">
          <a href="graph_lagrange_even.jpg"><img src="graph_lagrange_even.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The other half-integer support, Lagrange Filters (generating even orders), produce a very disjoint set of filter weightings, and much like the '<code>Box</code>' filter, they can produce some strong <a href="#blocking">blocking</a> resize artifacts. On the other hand for small scale resize this can ensure that images keep sharp for very small resize adjustments. These 'even' ordered '<code>Lagrange</code>' filters actually highlight the main disadvantage of using this filter, which is that the weighting function is not a 'smooth' gradient. In large scale enlargements this means you can get visible changes in the generated gradient. This is rarely a problem however, except in those extreme cases. Basically it represents a filter that universally creates an appropriate for the current '<a href="#support">support</a>' setting, regardless of how big or small that setting is. It is a self-windowing resize filter.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The '<code><a href="#lagrange">Lagrange</a></code>' filter was not fully defined and usable until IM version v6.3.7-1.</i></font></td>
            </tr>
          </table><a name="cubics" id="cubics"></a> <a name="spline-c" id="spline-c"></a> <a name="hermite-c" id="hermite-c"></a> <a name="catrom-c" id="catrom-c"></a>
          <h3>Cubic Filters</h3>As many image experts were trying to find a better and faster-to-calculate filter for image resizing, a family of filters evolved, and became known as Cubic Filters. These are much like the <a href="#lagrange">Lagrange Filters</a> shown previously, and were made up of a smaller fixed set of piece-wise sections. However unlike Lagrange filters the pieces were designed to fit together to form a smooth curve, to reduce sharp <a href="#blocking">blocking</a> effects. <a href="graph_cubics.jpg"><img src="graph_cubics.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> Shown in the graph left are four such 'smooth' cubic filters that are pre-defined within IM, and well known for use as resize filters. The '<b><code>Spline</code></b>' filter (also used as an alias and default seetings for the general '<code>Cubic</code>' filter function) emulates a <a href="#gaussian">Gaussian Blurring Filter</a>. This curve is also known as a 'B-Spline' interpolation curve, and is also commonly used for drawing smooth lines through a collection of points. It is also often used for camera and object motions in animations, to produce a smooth flow though the user provided control points. Also shown is '<b><code>Catrom</code></b>', or more correctly the 'Catmull-Rom Filter' or the 'Keys Cubic Convolution' which generates a smooth non-blurring form of <a href="#interpolated">Interpolation Filter</a>. However it can overshot slightly. It is essentually an ideal self-sharpened filter, and as such also the function commonly used for basic <a href="../misc/#bicubic">Bi-Cubic Interpolation</a>. And finally the '<b><code>Hermite</code></b>' Cubic filter, which is type of smoothed triangular <a href="#interpolated">Interpolation Filter</a>, That will smooothly slow (roll off) at the input coordinates. Basically it rounds off strong edges while preserving flat 'color levels' in the original image.
          <h4>Cubic Filter Families</h4>The above are the most common 'named' filters of the Cubic Curves, but they also belong to specific families of Cubic Filters. The '<b>B-Spline' family</b> of cubics is essentually equivelent to various degrees of <a href="#blurring">blurring</a> of the results. Typically ranging from the very <a href="#blurring">blurry</a> '<code>Spline</code>' filter, and the edge rounding but <a href="#blocking">blocky</a> results of the '<code>Hermite</code>' filter. Then there was the '<b>Cardinal' family</b>, which produces filters compromising between <a href="#blocking">blocking</a> and <a href="#ringing">ringing</a> artifacts and from which the 'Catmull-Rom Filter' ('<code>Catrom</code>') evolved as a balanced compromise of these artifacts. These two families then merged to form the '<b>Keys Cubic Filter Family</b>', which linked the 'Catmull-Rom Filter' (Keys <b>α</b> = 0.5) with the 'B-Spline Cubic Filter' (Keys <b>α</b> = 0.0). The Keys family of filters also has the special property of preserving any linear (affine) gradient that may exist across the image. The <a href="#ringing">ringing</a> and <a href="#blurring">blurring</a> effects of a keys family filter would only come into play when an image contains strong color changes, rather than smooth gradients of color. Confused by the variety? Of course you are. So was everyone else! The problem is that the results of filters are often very subjective, dependant on the image, and the restrictions of the 'family' you are using. Just what made a good filter really depended on who you asked, whether you were enlarging or shrinking, and what image you were processing. In some ways it still is, confusing. It took me over two years of muddling around, reading, and playing with the various filters to come up with the start of this summery, and even now it is still evolving. Image resizing is a very subjective area, difficult (actually its proven to be imposible) to quantify in any real way. There is no such thing as a 'perfect' resize. <a name="mitchell" id="mitchell"></a>
          <h4>Mitchell-Netravali Filter</h4>Into this, Don P. Mitchell and Arun N. Netravali, came out with a paper, '<a href="http://www.cs.utexas.edu/users/fussell/courses/cs384g/lectures/mitchell/Mitchell.pdf">Reconstruction Filters in Computer Graphics</a>', which formulated two variables known as 'B' (as used for 'B-spline' curves) and 'C' (as used for the 'Cardinal' curves and equivalent to the 'Keys' filter <b>α</b> value). With these two values you can generate any smoothly fitting (continuious first derivative) piece-wise cubic filter. <img src="../img_diagrams/cubic_survey.gif" width="301" height="320" align="right" vspace="0" hspace="2" border="1" alt="[IM Output]"> More importantally they then surveyed a group of 9 image processing experts, rather than just relying on their own oppion, to classify the <a href="#artifacts">Artefacts</a> produced by slightly enlarging images using various values of B and C. The results of that survey are shown in the recreated diagram to the right. The 'green' area represented values the experts regarded as producing an acceptable result, while the various other areas produce the various types of <a href="#artifacts">Artefacts</a>. This image is important, as it really shows the relationships between the various <a href="#artifacts">Artefacts</a> and the various different types of filters that can be produced. You can also see from the results why the 'Keys' family of filters became so important, as one of the better methods of generating good cubic filters. Its filters basically fell in a line directly through the area regarded as 'acceptable' by the image processing experts. From this survey, Mitchell and Netravali determined that the best filter was a 'Keys' family filter, which fell in the middle of the acceptable area, using B,C values of 1/3,1/3. This filter is now known as the 'Mitchell-Netravali Filter' and is available in IM as the '<b><code>Mitchell</code></b>' filter setting. Basically it is a compromise of all the resize artifacts. It is also the default filter used for IM image enlargements. All the built-in 'named' Cubic filters: '<code>Mitchell</code>', '<code>Robidoux</code>', '<code>Catrom</code>', '<code>Spline</code>', and '<code>Hermite</code>'; have also been marked in the above diagram, showing what those experts would think of those specific filters. Also shown are the lines representing the 'B-Spline', 'Cardinal' and 'Keys' filter families. Internally all these filters only differ by the pre-defined B,C settings of the filter, in fact IM uses the same internal function to generate all cubic filters, only with different B,C settings to define those filters. <a name="cubic_bc" id="cubic_bc"></a>
          <h4>Cubic B,C Expert Controls</h4>You can use the special expert settings to set the B,C settings that a <a href="#cubics">Cubic Filter</a> is using. To do this you need to select the general '<code>Cubic</code>' filter 'function' (or any of the other named cubic filters), and the desired '<code>b</code>' and '<code>c</code>' expert settings. For example...
          <pre>   -filter Cubic
   -define filter:b=<i>value</i>
   -define filter:c=<i>value</i></pre>The expert settings will override the internal defaults for the given filter when it is used by a resize or distort operator. As such the order of the above options does not matter, as long as you have "<code><a href="../option_link.cgi?define">-define</a></code>" or "<code><a href="../option_link.cgi?set">-set</a></code>" all the global expert settings desired before the image processing operator is used. If one of the '<code>b</code>' or '<code>c</code>' settings has not been defined or set, its value will be calculated from the other value on the assumption that you are wanting a 'Keys' family filter (along the dotted line in the Mitchell-Netravali Survey diagram). Remember the '<code>c</code>' is equivalent to the Keys <b>α</b> setting, while '<code>b</code>' can be thought of as a cubic spline 'blur' setting. These expert settings provide a good way for users to 'tune' their image resizing to get exactly what they want (whether they are using <a href="../resize/#resize">Resize</a> or <a href="../distorts/#distort">Distort</a>). The '<code>b</code>' setting is easier of the two to understand. Just think of 'b' as 'bluriness'. A value of b=0 is the very sharp (Catmull-Rom filter), which tends to produce a negative halo <a href="#ringing">Ringing</a> and some <a href="#aliasing">Aliasing or Moiré</a> effects. A value of b=1 tends to produce an overly blurry (the Spline or Gaussian-like) effect. This makes it easy for experts (or even normal users) to adjust this value to find a filter that is 'good to them'.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td align="justify">
                To the right is a table of the B,C values for the specifically 'named' <a href="#cubics">Cubic Filters</a>. Remember '<code>Hermite</code>' is the only built-in cubic filter that does not form part of the 'Keys' filter family. It also has the smallest support ('<code>1.0</code>') of all the BC Cubic filters, and does not contain a negative lobe. The '<code><a href="#robidoux">Robidoux</a></code>' and '<code><a href="#robidoux_sharp">RobidouxSharp</a></code>' filters are very similar to '<code>Mitchell</code>', but rather than the result of a survey, they were determined mathematically for special use as a <a href="#cylindrical">Cylindrical Filter</a>. The '<code><a href="#robidoux">Robidoux</a></code>' filter is the default filter used by the <a href="../distorts/#distort">General Distort Operator</a> (see below).
              </td>
              <td>&nbsp;</td>
              <td>
                <table class="table table-sm table-hover table-striped" bgcolor="#F8F8F8">
                  <tr>
                    <th>Filter</th>
                    <th>B<br>
                    &nbsp;blur&nbsp;</th>
                    <th>C<br>
                    Keys&nbsp;α</th>
                  </tr>
                  <tr>
                    <td>Hermite</td>
                    <td align="center">0.0</td>
                    <td align="center">0.0</td>
                  </tr>
                  <tr>
                    <td>Spline</td>
                    <td align="center">1.0</td>
                    <td align="center">0.0</td>
                  </tr>
                  <tr>
                    <td>Catrom</td>
                    <td align="center">0.0</td>
                    <td align="center">1/2</td>
                  </tr>
                  <tr>
                    <td>Mitchell</td>
                    <td align="center">1/3</td>
                    <td align="center">1/3</td>
                  </tr>
                  <tr>
                    <td>Robidoux</td>
                    <td align="center">0.3782</td>
                    <td align="center">0.3109</td>
                  </tr>
                  <tr>
                    <td>Robidoux<br>
                    Sharp</td>
                    <td align="center">0.2620</td>
                    <td align="center">0.3690</td>
                  </tr>
                  <tr>
                    <td>Robidoux<br>
                    Soft</td>
                    <td align="center">0.6796</td>
                    <td align="center">0.1602</td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The '<code>Parzen</code>' windowing filter uses a '<code>Spline</code>' filter as its windowing function. As such you can re-define this windowing filter in terms of B,C expert options. How useful this is, and what effect it has on the resulting windowed Sinc (or Jinc), is unknown, and not recommended.</i></font></td>
            </tr>
          </table><a name="cylindrical" id="cylindrical"></a>
          <h3>Cylindrical Filters <font size="-1">- for Distort</font></h3>As we have touched on a number of times already, the <a href="../distorts/#distort">Distort Operator</a> uses the filter setting to resample images in a slightly different way to the <a href="../resize/#resize">Resize Operator</a>. Specifically <a href="../distorts/#distort">Distort</a> applies the filter using the 'radial' distance between the 'sample point' and the actual pixels within the sampling area of the source image, to determine weights of each pixel and thus the final color at the sample point. <a href="../resize/#resize">Resize</a> in contrast, processes the image twice using orthogonally aligned filters. Once in the X direction, and then again in the Y direction, it is thus limited to simple rectangular resizing of images, and does not involve the use of <a href="../misc/#virtual">Virtual-Pixels</a>. That is, to say <a href="../distorts/#distort">Distort</a> applies the filters to produce '<i>Cylindrical</i>' shapes rather than 'Box' shapes, so as to allow free-form distortions of images, including rotations and variable scaling (stretching and compression) in any direction, not just along the X or Y axis.Because of this the filters themselves often need to be adjusted or are designed specifically for this type of usage. <a name="cyl_interpolated" id="cyl_interpolated"></a>
          <h4>Interpolated Cylindrical Filters</h4>Here I use a '<code><a href="#box">Box</a></code>' filter to enlarge a single pixel image by 30 times using the equivalent <a href="../resize/#resize">Resize</a> and <a href="../distorts/#distort">Distort</a> operators.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick xc:  -bordercolor black -border 1 \
          -filter Box   -resize 3000%      dot_resize_box_black.png
  magick xc:  -bordercolor black -border 1 \
          -filter Box   +distort SRT 30,0  dot_distort_box_black.png
</samp></pre>
                </td>
              </tr>
            </table>
            <table cellpadding="0" cellspacing="0">
              <tr valign="bottom">
                <td align="center">
                  <a href="dot_resize_box_black.png"><img src="dot_resize_box_black.png" align="middle" vspace="2" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Resize
                </td>
                <td align="center">
                  <a href="dot_distort_box_black.png"><img src="dot_distort_box_black.png" align="middle" vspace="2" hspace="25" border="1" alt="[IM Output]"></a><br>
                  Distort
                </td>
              </tr>
            </table>
          </div>As you can see when the '<code><a href="#box">Box</a></code>' filter is used as a Cylindrical filter you get a circle (or a cylinder in 3 dimensions). However because of the way the filter is handled you get some areas where two pixels are sampled (equally) to produce a perfect mid-tone gray. You can think of a cylindrical box filter converting the source image into a whole set of overlapping circlular pixels that are blended (not added) together. Here is a more colorful example of the results of expanding an image using a 'Cylindrical Box' filter for enlargement...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick \( xc:red   xc:white xc:black +append \) \
          \( xc:blue  xc:lime  xc:white +append \) \
          \( xc:black xc:red   xc:blue  +append \) -append \
          -filter Box   +distort SRT 30,0  color_box_distort.gif
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="color_box_distort.gif"><img src="color_box_distort.gif" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>With a distorted image, these circular pixels are also distorted into a set of overlapping ellipses. For example...
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr>
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick \( xc:red   xc:white xc:black +append \) \
          \( xc:blue  xc:lime  xc:white +append \) \
          \( xc:black xc:red   xc:blue  +append \) -append \
          -alpha set -virtual-pixel transparent -filter Box \
          +distort Perspective '0,0 0,0  0,3 0,90 3,0 90,30 3,3 90,60' \
          color_box_distort.png
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="color_box_distort.png"><img src="color_box_distort.png" align="middle" vspace="0" hspace="5" border="0" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The support 'radius' for a cylindrical '<code>Box</code>' filter is increased from '<code>0.5</code>' to '<code>0.707</code>' (<code>sqrt(2)/2</code>). This ensures the filter will always find at least one source pixel in the circular sample area (diagonally). This is the minimum practical support size for any cylindrical filters.<br>
              <br>
              No other filter has this coverage problem, requiring an increase in support.</i></font></td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/expert.gif" width="23" height="26"><img src="../img_www/space.gif" width="17" height="16"></td>
              <td align="justify" width="100%">
                <font size="-1"><i>If the support is not at least '<code>0.707</code>', then you may get areas of your image in which the filter 'misses' all source pixels, and thus produce a <a href="../distorts/#distort_failure">Resampling Failure</a>.<br>
                <br>
                Using a larger support setting also produces interesting patterns. As 'circles' become larger, and more pixels will become blended together. For example...</i></font>
                <table border="0" cellspacing="0" cellpadding="0" width="100%">
                  <tr>
                    <td width="100%" align="justify">
                      <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                        <tr>
                          <td>
                            <pre class="bg-light text-dark mx-4"><samp>
  magick \( xc:red   xc:white xc:black +append \) \
          \( xc:blue  xc:lime  xc:white +append \) \
          \( xc:black xc:red   xc:blue  +append \) -append \
          -filter Box -define filter:support=0.83 \
          +distort SRT 30,0  color_box_distort_overlap.png
</samp></pre>
                          </td>
                        </tr>
                      </table>
                    </td>
                    <td>
                      <a href="color_box_distort_overlap.png"><img src="color_box_distort_overlap.png" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
                    </td>
                  </tr>
                </table><font size="-1"><i>The result is a sort of circular form of a <a href="../misc/#blend">Blend Interpolation</a>.<br>
                <br>
                At a support of 1.0 or larger every resample will be a 'box' or 'average' blending of at least two pixels.<br>
                <br></i></font>
              </td>
            </tr>
          </table><br>
          Here is a comparison of a number of the interpolation filters. Gray colors are used so that you can see over and undershoots. The top line using an orthogonal resize, while the bottom line uses a cylindrical distortion.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" script="">
  for filter in box triangle hermite lagrange catrom
  do
    magick xc:gray80  -bordercolor gray20 -border 2 \
            -filter $filter   -resize 2000%      dot_resize_$filter.png
    magick xc:gray80  -bordercolor gray20 -border 2 \
            -filter $filter   +distort SRT 20,0  dot_distort_$filter.png
  done
</code></pre>
                </td>
              </tr>
            </table>
            <table cellspacing="0" cellpadding="0" width="90%">
              <tr>
                <td align="center">
                  <a href="dot_resize_box.png"><img src="dot_resize_box.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  <a href="dot_distort_box.png"><img src="dot_distort_box.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  Box
                </td>
                <td align="center">
                  <a href="dot_resize_triangle.png"><img src="dot_resize_triangle.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  <a href="dot_distort_triangle.png"><img src="dot_distort_triangle.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  Triangle
                </td>
                <td align="center">
                  <a href="dot_resize_hermite.png"><img src="dot_resize_hermite.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  <a href="dot_distort_hermite.png"><img src="dot_distort_hermite.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  Hermite
                </td>
                <td align="center">
                  <a href="dot_resize_lagrange.png"><img src="dot_resize_lagrange.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  <a href="dot_distort_lagrange.png"><img src="dot_distort_lagrange.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  Lagrange
                </td>
                <td align="center">
                  <a href="dot_resize_catrom.png"><img src="dot_resize_catrom.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  <a href="dot_distort_catrom.png"><img src="dot_distort_catrom.png" align="middle" vspace="2" hspace="2" border="1" alt="[IM Output]"></a><br>
                  Catrom
                </td>
              </tr>
            </table>
          </div>You can see how the results are similar but with different syles of <a href="#artifacts">Artefacts</a> being generated, both internally and externally (ringing), by the two different ways in which the filter is being applied. The internal artifacts is especially evident in the '<code>Triangle</code>' filter. However remember that interpolation filters are not particularly good for extreme minification (shrinking) of distorted images, but they are very good for magnification (enlarging). <a name="cyl_gaussian" id="cyl_gaussian"></a>
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="bottom">
              <td width="100%" align="justify">
                <h4>Cylindrical Gaussian</h4>The one filter which produces no difference in results between an orthogonal 'resize' and a cylindrical 'distort' forms, is the special '<code><a href="#gaussian">Gaussian</a></code>' filter...
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick xc:red -bordercolor yellow -border 1 \
          -filter Gaussian   +distort SRT 33,0  -normalize  dot_distort.jpg
</samp></pre>
                    </td>
                  </tr>
                </table>
              </td>
              <td>
                <a href="dot_distort.jpg"><img src="dot_distort.jpg" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>This is actually one of the special proprieties of this filter (known as separability), and one of the reasons why many cylindrical resampling implementations use it as the default filter. It was the default for the original EWA paper, but is also very blurry in its results. ImageMagick also used it when distorts were first implemented, but not any more. Just as it is for orthogonal resize, a '<code>Gaussian</code>' filter will produce absolutely no <a href="#aliasing">Aliasing Artefacts</a> in the resulting image, even when you apply it to the special 'rings' image. But the cost of this is a blurry result, even if little or no distortion is actually involved. Similarly as given in the discussion on the <a href="#sigma">Sigma Expert Control</a>, you can also use this filter as a type of interpolated filter.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>As of IM v6.6.5-0, IM no longer used this filter, by default for <a href="../distorts/#distort">Image Distortions</a>. Instead another filter '<code><a href="#robidoux">Robidoux</a></code>' filter specifically designed to produce a sharper result is used.<br>
              <br>
              In any case, before this version distortions were also very blurry due to a mistake in its implementation. Upgrade if you have an older version and want to use <a href="../distorts/#distort">Image Distortions</a>.<br>
              <br></i></font></td>
            </tr>
          </table>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/warning.gif" width="28" height="28"><img src="../img_www/space.gif" width="12" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>Before IM v6.6.7-6, IM would use a slightly larger 'sigma' value for a Cylindrical Gaussian, of 1/sqrt(2) or approximatally 0.707, instead of 1/2. This resulted in a slightly more blurry result, which was to reduce posible <a href="#aliasing">Aliasing Artefacts</a>.<br>
              <br>
              This was a mistake which was created by following a research papers recommendation, in passing the larger support for a <a href="#cyl_interpolated">Cylindrical Box Filter</a>, into the Gaussian Filter. The reasoning that was put forward was that Gaussian is essentually a blurred box. It isn't. A Gaussian is a blurred impulse not a blurred box. This version removed that mistake, which now means you should get equivelent results with either resize or distort, when the gausian filter is used.<br>
              <br>
              I personally find using this slightly larger sigma value does indeed smooth out any 'blocking' artifacts along aliased diagonal edges when doing enlargements of line drawings. But that is a special case.<br>
              <br></i></font></td>
            </tr>
          </table><a name="jinc" id="jinc"></a>
          <h4>Windowed Jinc Cylindrical Filters</h4><a href="graph_jinc.jpg"><img src="graph_jinc.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The <i>Jinc()</i> function (sometimes inaccurately called a '<code>Bessel</code>' filter) is the 'Sinc' equivalent for use with a cylindrical filtering operation. Though very similar and closely related to <i>Sinc()</i>, it is designed to filter a rectangular array of values using a radial or cylindrical distance, rather than only in orthogonal (axis aligned) directions. If you look at the provided graph of the <i>Jinc()</i> function, you will find that its first 'zero-crossing', representing first ring of near neighbours, falls between the values of 1.0 (for orthogonal neighbours) and the square root of 2. That is, the zero crossing has an approximate value of '<code>1.2196699</code>'. The way <i>Jinc()</i> function works is that if the sampling point is equal to an actual pixel value, the <i>Jinc()</i> function will assign a positive value to the slightly closer orthogonal neighbouring pixels, but then assign a similar negative value to the slightly further diagonal neighbours, and so on as it moves further though the 2 dimentional array of values. As a result, when no scaling (distortion) is performed the contributions of the neighbours should, in theory, cancel each other out. This is why the <i>Jinc</i> filter is mathematically the preferred solution to cylindrical resampling of a square array, and thus the 'ideal' filter for <a href="../distorts/#distort">Distort</a> elliptical resampling method (EWA). This is not to say it is a 'perfect' filter from a human point of view. Because of this, selecting any <a href="#windowed">Windowed Filter</a> while using the <a href="../distorts/#distort">Distort Operator</a>, will substitute the normal '<i>Sinc()</i>' function with the equivalent '<i>Jinc()</i>' function. As the <i>Jinc()</i> function has zero crossings are at non-integer positions, it is very important to specify the filters support in terms of special <a href="#lobes">Lobes Support Setting</a> introduced above for <a href="#windowed">Windowed Sinc Filters</a>. The biggest problem with using a 'Windowed Jinc' filter is when the source image contains a pixel level hash pattern (such as provided by "<code>pattern:gray50</code>", see <a href="https://imagemagick.org/script/formats.php#builtin-patterns">Built-In Patterns</a>). In this situation all the orthogonal neighbours are different to diagonal neighbours, and as a result, the image becomes heavily blurred by the '<i>Jinc()</i>' function. However just about any other pattern, such as lines, edges, corners, all remain quite sharp and clear when using a 'Windowed Jinc' filter, making it still a good function to use. This 'problem' can be a good thing, as it means that 2-dimentional cylindrical Jinc derived filter can be used as method of removing strong pixel hash type patterns from images, such as those generated by a <a href="../quantize/#dither">Color Reduction Dither</a>, without greatly effecting the sharpness of the rest of the image. That is, it could be used as a 'Dither Removal Method' (see below). <a name="distort_noop" id="distort_noop"></a>
          <h3>Distort and Filters in the No-Op case</h3>Ideally, no-op distortion should return exactly the same image. But as you have seen in previous examples, this may not actually happen. The resize (2-pass 1 dimensional) filters: Lanczos (Sinc-Sinc), Lanczos2, Catrom, Hermite, Triangle, and many other resize filters do have this property. The pixel pattern is preserved exactly if the image is not scaled. On the other hand smoothing or blurring filters, like Gaussian, Cubic, and Quadratic will blur an image if applied to a nearly no-op case. Note that even the resize filter default, Mitchell-Netravali, also contains some blur in it, as is basicaly a blend of B-spline 'Cubic' smoothing filter and the Cublic two-lobe sinc equivelent Catmull-Rom filter.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The resize operator will by default short-circuit itself, so as to do nothing for the no-op case. As such unless you specifically specify a filter you can not generate a 'noop' resize.<br>
              <br>
              Distort will never short-circuit for the no-op case, and that is to ensure consistancy in animations in which the distortion scaling may pass through the 'no-op' case. This is something that is typically not a concern with resize.<br>
              <br></i></font></td>
            </tr>
          </table>While many resize filters will preserve images in the no-op case. Cylindrical (distort) methods, will basically never produce a perfect no-op distortion. Any no-op distort will at least minimally distort the colors of an image, even though the image itself is not distorted. What happens is that by using a cylindrical filter, the contribution of orthogonal neighbourhood pixels will be different to that for diagonal neighbourhood pixels. They are essentually different distances from the lookup point (centered on an actual pixel for the no-op case. The 'Jinc' function tries to reduce this color distortion by canceling out the contributions of the orthogonal neighbours with that of the diagonal neighbours. That is, actually part of its mathematical definitation. In the worst case, a 'pixel level hash', every diagonal pixel neighbour is different to every orthogonal pixel neighbour. In this case the filter weightings will enhance rather than cancel the contributions. As a result this type of image will tend to produce very sever color distortions for a no-op distortion of any image containing a 'pixel level hash'. Here for example I actually use this special property to remove a hash pattern from an image. No scaling is used, just a distortion applied 2-dimentional 'convolution' on the image.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" script="">
  magick -size 100x100 pattern:gray50  hash.png
  magick hash.png -filter Lanczos -distort resize 100% hash_removed.png
</code></pre>
                </td>
              </tr>
            </table>
            <table cellspacing="5" cellpadding="0">
              <tr valign="top">
                <td align="center"></td>
                <td align="center">
                  <a href="hash.png"><img src="hash.png" width="100" height="100" align="middle" vspace="0" hspace="15" border="1" alt="[IM Output]"></a>
                </td>
                <td align="center"><img src="../img_www/right.gif" width="20" height="20" vspace="40" alt="==&gt;"></td>
                <td align="center">
                  <a href="hash_removed.png"><img src="hash_removed.png" width="100" height="100" align="middle" vspace="0" hspace="15" border="1" alt="[IM Output]"></a>
                </td>
              </tr>
            </table>
          </div>
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The reason the percieved gray-level of the hash is so much darker than the the overall gray-level of the hash is because of the way <a href="../color_basics/#perception">Human Color Perception</a> works.<br>
              <br>
              The fix is to include '<code>-set colorspace RGB</code>' in the above to tell IM that we are resizing in linear-RGB colorspace See <a href="../resize/#resize_colorspace">Resizing with Colorspace Correction</a>.<br>
              <br></i></font></td>
            </tr>
          </table>The above is actually equivelent to a <a href="../convolve/#intro">Convolution</a> with a Jinc-like kernel function. But as you can see the special property of the Jinc Function (in this case EWA Lanczos, or Jinc windowed Jinc), completely removed the hash pattern that was strongly present in the original image. The only part where it now remains is along the edges, where the 'abyss' (no virtual pixel contribution) that surrounds the image proper, can effect the results. The actual number of lobes of a Windowed Jinc filter, has an enormous bearing on the results as well. With 2 lobes, a 'pixel level hash' has a tendancy to be preserved, though dulled or blurred.
          <table border="0" cellspacing="0" cellpadding="0" width="100%">
            <tr valign="top">
              <td width="100%" align="justify">
                <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="100%" bgcolor="#F8F8F8">
                  <tr>
                    <td>
                      <pre class="bg-light text-dark mx-4"><samp>
  magick hash.png -filter Lanczos2 -distort resize 100% hash_2_lobes.png
</samp></pre>
                    </td>
                  </tr>
                </table>The contribution of the windowing method applied to the Jinc function, will also have major influence on this effect. In some case even enhance the hash pattern further.
              </td>
              <td>
                <a href="hash_2_lobes.png"><img src="hash_2_lobes.png" width="100" height="100" align="middle" vspace="0" hspace="5" border="1" alt="[IM Output]"></a>
              </td>
            </tr>
          </table>The question thus arises of how to tune the distort filters so as to minimize the color distortions generated by the filter for a no-op distortion. The way Nicolas Robidoux decided to do this was by selecting a blur (rescaling of the support of the filter kernel) that tends to preserve orthogonal edges as much as posible. <a name="lanczos_cylindrical" id="lanczos_cylindrical"></a>
          <h4>Cylindrical Lanczos Filter</h4>Now as discussed above "<a href="#lanczos"><code>Lancoz</code></a>" is normally defined as a '<i>Sinc()</i>' function used both the weighting and windowing of the filter. But when used as an EWA cylindrical filter, BOTH of the weighting functions will be replace by the '<i>Jinc()</i>' function. That is, not only is the weighting function replaced (as it is for the other linear windowed filters), but it also replaces the windowing function, producing a Jinc windows Jinc weighting function. As such a 'Cylindrical Lanczos' will select a "Jinc windowed Jinc" with the same number of lobes (default 3). This technique was first advocated by Andreas Gustafsson, in thesis on <a href="http://www.gson.org/thesis/warping-thesis.pdf">Interactive (Local) Image Warping</a> (page 24). He specifically used a 2-lobed Cylindrical Lanczos (Jinc windowed Jinc) filter which he named '<code>Lanczos2D</code>' (see next). This was simply an obvious extension for the planar (EWA) situation. Hence the use of the same name. For more info on this see this <a href="../forum_link.cgi?f=22&amp;t=19823&amp;p=79247">Post in BC-splines Discussion</a>. <a name="lanczos2" id="lanczos2"></a>
          <h4>Lanczos2 - 2-lobed Lanczos</h4>For convenience this two lobed version, simply named '<code><b>Lanczos2</b></code>', was included in IM v6.6.4-10, specially for use in distortions.It is really just a cylindrical '<code>Lanczos</code>' (Jinc-Jinc) filter with a '<code>filter:lobes=2</code> expert setting. See the <a href="graph_jinc.jpg">graph above</a>, and as IM filter automatically switches between using <i>Sinc()</i>, and <i>Jinc()</i> functions as appropriate, it is not just for a '2D' (cylindrical) use. It can can also be used for resize too (as a Sinc-Sinc function), though I don't recommend it as it is probably a bit too small, and becomes pratically equivelent to the various other cubic functions. <a name="lanczos_sharp" id="lanczos_sharp"></a>
          <h4>LanczosSharp - A slighly sharpened Lanczos</h4>It was observed that windowing a <i>Jinc()</i> function leads to much blurrier EWA distort results, than analogous windowed <i>Sinc()</i> function, in the orthogonal resize results (especially with thin lines). This was particularly the case for mild distortions. Basically, the <i>Jinc()</i> function has some special properties and windowing the <i>Jinc()</i> function messes up those specific and desirable properities. With some calculation, Nicolas Robidoux, Professor of Mathematics at Laurentian University, was able to work out a slightly sharper version of a 3-lobed Cylindrical Lanczos, now available as '<code><b>LanczosSharp</b></code>', that to some extent fixed the problem for distorting images. However the resulting filter still has the strong blurring of low level 'pixel hash' patterns, of <a href="#jinc">Windowed Jinc Cylindrical Filters</a>. <a name="lanczos2sharp" id="lanczos2sharp"></a>
          <h4>Lanczos2 Sharpened</h4><a href="graph_cyl_lanczos_2.jpg"><img src="graph_cyl_lanczos_2.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> The same problem was more severe in '<code>Lanzcos2</code>' filters, so Nicolas also produce a sharper '<code><b>Lanczos2Sharp</b></code>' filter, using a slightly larger <a href="#blur">Blur Expert Control</a>. This resulted in a filter with only minimal blurring for vertical or horizontal lines in a 'no distort' case. This sharpened filter results in a small shift of the zero point, so that it is now located at approximatally '<code>1.1684</code>'. This may not seem like much but it makes a huge difference in the amount of blur the filter generates for images with little to no distortion. <a name="lanczos_radius" id="lanczos_radius"></a>
          <h4>Lanczos Radius</h4><a href="graph_cyl_lanczos_3.jpg"><img src="graph_cyl_lanczos_3.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> This is an EWA Lanczos filter that is blurred (sharpened) so that the number of lobes used (3 by default) fits into an integer support radius. That is a 3 lobe EWA Lanczos (based on a Windowed Jinc) is sharpened to have a support of exactly radius 3. You can use the <a href="#lobes">Lobes Expert Control</a>, to achieve the same result, but as it involves an adjustment based on the known zero crossing of the Jinc function, but it is not an easy calculation to make. Nicolas recommended the addition of this filter so you don't need to do that calculation, and allow you to test out this very specifically sharpened filter. <i>FUTURE: table of blur factors to the Jinc Windowed Jinc filters.<br>
          Include number of lobes as a reference.</i> <a name="robidoux" id="robidoux"></a>
          <h4>Robidoux Cylindrical Filter</h4><a href="graph_robidoux.jpg"><img src="graph_robidoux.gif" width="180" height="120" align="right" vspace="0" hspace="5" border="1" alt="[IM Output]"></a> Strangely, experiments were showing that using a <a href="#mitchell">Mitchell-Netravali</a> filter as a cylindrical filter was producing near equivalent 'sharp' results for the 'no distort' case. And yet the filter has no relationship to its use as a cylindrical filter, as it was selected by a 'social study' for orthogonal (resize) filtering. The '<code>Mitchell</code>' filter was especially good at preserving low-level 'pixel hash' patterns, which normal <a href="#jinc">Windowed Jinc Filters</a> destroyed in cylindrically filtered images. Nicolas then found that by a bizarre coincidence that '<code>Mitchell</code>' was extremely close to the 'sharpened' form of '<code>Lanzcos2</code>' filter discussed above. This in turn lead to him developing a <a href="#cubics">Keys Cubic Filter</a> which preserves vertical (and horizontal) lines perfectly. Also this new filter does so at a lesser computational cost, as a cubic function is very cheap to compute than a Jinc function. This cubic filter has been added to IM as the '<code><b>Robidoux</b></code>' filter, as of IM v6.6.5-0, and is also the default filter used by <a href="../distorts/#distort">Distort</a> and its <a href="../distorts/#area_resample">Elliptical Weighted Resampling</a> method, specifically due to its minimal-blur propriety for images with only minimal distortion. That is, not to say that it is 'the best' filter to use, and even Nicolas likes to use other filters, but it is a very good compromise, just as '<code>Mitchell</code>' is a good compromise for orthogonal (tensor) resizing. I have marked this filter on the "<a href="../img_diagrams/cubic_survey.gif">Cubics Map</a>" generated by the <a href="#mitchell">Mitchell-Netravali Survey</a>, so you an see just how closely related to the '<code><a href="#mitchell">Mitchell</a></code>' filter it is. It would in fact make a reasonable filter for either orthogonally resized or cylindrically distorted images. <a name="robidoux_sharp" id="robidoux_sharp"></a>
          <h4>Robidoux Sharp Cylindrical Filter</h4>The '<code><b>RobidouxSharp</b></code>' filter is a slightly sharper version of the '<code><a href="#robidoux">Robidoux</a></code>' filter, though some feel that the results are too sharp. It is designed specifically so as to preserve images containing pure black and white pixels with the minimum of error, in the "no-distort" case. Specifically that the weightings the orthogonal neighbouring pixels, exactly match the negative weightings of diagonal neighbouring pixels in a 'no-distort' case. By coincidence the '<code><a href="#mitchell">Mitchell</a></code>' filter happens to fall almost exactly between the '<code><a href="#robidoux">Robidoux</a></code>' filter and the '<code><a href="#robidoux_sharp">RobidouxSharp</a></code>' filter, and all belong to the <a href="#cubics">Cubic Keys</a> family of filters. As such users can select from any of these three filters to control the blur-sharpness of results in near 'no-distort' situations. For details of this filter see the <a href="../forum_link.cgi?f=22&amp;t=19823&amp;p=83898">BC-splines</a> discussion on IM Forums. <a name="robidoux_soft" id="robidoux_soft"></a>
          <h4>Robidoux Soft Cylindrical Filter</h4>This was added much later, and is very different to the other Cylindrical filters seen. Yes it is much more blurry to make it more useful for upsizing or enlarging images, which allows it to avoid some staircasing effects on photos of brick buildings. For more info on this see this <a href="../forum_link.cgi?f=22&amp;t=19823&amp;p=109820">Post in BC-splines Discussion</a>. as well as this discussion from a <a href="http://www.luminous-landscape.com/forum/index.php?topic=77949.msg723814#msg723814">photo processing forum discussion</a>. <a name="cyl_summary" id="cyl_summary"></a>
          <h4>Cylindrical Filter Summary</h4>Nicolas Robidoux in the long, and on going, forum discussion on the <a href="../forum_link.cgo?p=83754">Proper Scaling of a Jinc Filter in EWA</a> gives this as a summary of cylindrical filters...
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td align="justify" width="100%"><font size="-1">If Robidoux is too soft and RobidouxSharp too aliased, I suggest that you try Mitchell (with distort Resize), which is pretty much halfway.<br>
              <br>
              Because JPEG involves a (Discrete) Cosine Transform, I am not surprised that the filters based on Fourier considerations (Lanczoses et al, whether resize with Sinc or distort with Jinc) generally do better than those based on "good approximations of smooth functions" (those based on Keys cubics: Robidoux, Mitchell, RobidouxSharp, CatRom, whether with resize or distort). That advantage appears to be less with PNGs (which does not destroy information through the Fourier domain).<br>
              <br></font></td>
            </tr>
          </table>Nicolas has a lot more to say. So much he has his own section <a href="nicolas/">Resampling by Nicolas Robidoux</a> which is now a separate and extensive page in its own right.
          <hr>
          <!-- ---------------------------------------------------------------- -->
          <a name="options" id="options"></a>
          <h3>Expert Filter Controls</h3>In the various sections above I introduce a large number of special 'expert' controls, which will allow you to modify the various filters in various ways. You define these expert settings using <a href="../basics/#define">Global Define Setting</a> (or equivalent <a href="../basics/#set">Set Option</a>). A full summary of all the expert option in the <b>IM Command Line Options Reference Page</b> for "<code><a href="../option_link.cgi?filter">-filter</a></code>". The "<code><a href="../option_link.cgi?filter">-filter</a></code>" setting is in fact only used to lookup and set the expert controls appropriately so as to define the given 'named' resize filter. These settings will override those default values as specified above, at the time filter is setup for a specific resize or distortion image processing operation.
          <table border="0" cellspacing="0" cellpadding="0" width="90%" align="center">
            <tr valign="top">
              <td><img src="../img_www/reminder.gif" width="20" height="16"><img src="../img_www/space.gif" width="20" height="16"></td>
              <td align="justify" width="100%"><font size="-1"><i>The "<code><a href="../option_link.cgi?filter">-filter</a></code>" setting 'Point' completely bypasses all the above filter setup, and degenerates into an unscaled 'Nearest Neighbor' direct lookup (resize), or interpolated lookup (distort). Thus this named filter setting effectively turns off the scaled image lookup filter completely.</i></font></td>
            </tr>
          </table>Now while they are available. I would like to make one final point.
          <div align="center">
            <b>Unless you are an expert (or just playing) -- It is best NOT use them!</b>
          </div>There are few people who are expert at image processing, and unless you know exactly what filters do and how changing them effects the filtering method, all you are likely to do is destroy the effectiveness your image processing, and produce a bad looking results. Especially in images other than your test cases. That is, not to say users should not use them, and many IM Examples do make use of them, but it is usually done to provide some special effect. When a special option is used the reason for its use is also explained, and you should stick to the recipe given for that effect. You are of course welcome to use them and you can generate some very interesting and highly unusual effects by making use of them.
          <h4>The 'verbose' Filter Control</h4>The setting "<code>filter:verbose</code>" is perhaps your best friend in figuring out and understanding the other filter controls. For example you can verify that the Lanczos filter is defined in terms of a Sinc windowed Sinc support 3.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" image="filter_verbose.txt" out="filter_verbose.txt">
  magick null: -filter Lanczos -define filter:verbose=1 \
          -resize 2    null:    | grep '^#'
</code></pre>
                </td>
              </tr>
            </table>
            <table border="0" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <a href="filter_verbose.txt"><img src="filter_verbose.txt.gif" align="middle" vspace="0" hspace="0" border="0" alt="[IM Text]"></a>
                </td>
              </tr>
            </table>
          </div>Note that internally the Lanczos filter is defined in terms of a fast polynomial equivalent 'SincFast' (4 lobe) function, rather than a full 'Sinc' function which is defined in terms of far more computationally intensive Trigonometric Library functions. Here we see that the Lanczos filter is defined as a Jinc windowed Jinc filter when used with as a cylindrical (<a href="../distorts/#area_resample">EWA Algorithm</a>) "-distort" filter.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre><code execute="" image="filter_verbose2.txt" out="filter_verbose2.txt">
  magick null: -filter Lanczos -define filter:verbose=1 \
          -distort SRT 0   null:   | grep '^#'
</code></pre>
                </td>
              </tr>
            </table>
            <table border="0" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <a href="filter_verbose2.txt"><img src="filter_verbose2.txt.gif" align="middle" vspace="0" hspace="0" border="0" alt="[IM Text]"></a>
                </td>
              </tr>
            </table>
          </div>The '<code>filter:verbose</code>' setting is the only way users can check on exactly what the final resultant filter is, due to the use of the various expert settings. After the '#' commented header of filter settings, a set of data points generated by the filter is returned. These are specifically provided for graphing the filters data, and lets you further verify and check just what the filter is producing without making guesses from the results of test images. For example, extract the data of a Welch Windowed Sinc Filter...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick null: -filter Welch -define filter:verbose=1 \
          -resize 2 null:  &gt; filter_welch.dat
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Or the raw Welch Windowing Function that was used in the above, with the window function scaled a support range of 0 to 1.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick null: -define filter:filter=Box \
                -define filter:window=Welch \
                -define filter:support=1.0 \
                -define filter:verbose=1 \
           -resize 2 null:  &gt; window_welch.dat
</samp></pre>
                </td>
              </tr>
            </table>
          </div>You can then plot that data with the "<a href="http://www.gnuplot.info/">gnuplot</a>" command (like I did in <a href="#windowed">Windowed Sinc Filters</a> above)...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  gnuplot
    set grid
    plot "window_welch.dat" with lines
</samp></pre>
                </td>
              </tr>
            </table>
          </div>
          <h4>Other Examples of Expert Filter Controls</h4>Create a 'Raw 8 lobed Sinc' filter can be set using...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -define filter:filter=Sinc
  -define filter:lobes=8
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Use the Blackman windowing function directly as a filter (as IM did by mistake, before v6.3.6-3).
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -define filter:filter=Blackman
  -define filter:support=4.0
</samp></pre>
                </td>
              </tr>
            </table>
          </div>The windowing function will default to 'Box' when undefined. A 'Box' windowing function will result in no windowing of the base filter function. For example a 'Gaussian' filter by default has a 'Box' windowing function. The only effect a box windowing function has is a clipping of windowed area of the function. See <a href="#support">Filter Support Expert Control</a> above. Force the use a raw Jinc function (explicitly setting 'Box' windowing) using...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -define filter:filter=Jinc
  -define filter:window=Box
  -define filter:lobes=3
</samp></pre>
                </td>
              </tr>
            </table>
          </div>A 12 lobed 'Lanczos' windowed filter clipped to just the first 8 lobes of the resulting windowed filter...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -filter Lanczos
  -define filter:win-support=12
  -define filter:support=8
</samp></pre>
                </td>
              </tr>
            </table>
          </div>This makes it about four times faster, by ignoring (support clipping at 8) the window-modulated 'tail' (to 12) of the resulting windowed-sinc filter. This however may result in some extra but minor artifacts as a result of the support clipping. Using Gaussian to 'blur' an image! This is equivalent to a -gaussian 5x2 operation, but by using a no-op distort!
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -filter Gaussian
  -define filter:sigma=2
  -define filter:support=5
  -distort SRT 0
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Note: you can not use -resize for this, as it may short circuit the operation and result in operation not being performed at all. Create a different filter from the 'Mitchell-Netravali' survey.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -filter Cubic
  -define filter:b=0.5
  -define filter:c=0.5
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Create your own 'Keys Cubic' filter with α value of 0.4...
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -filter Cubic
  -define filter:c=0.4
</samp></pre>
                </td>
              </tr>
            </table>
          </div>Nicholas Robidoux creating this weird filter while exploring '<a href="../forum_link.cgi?t=20007">Interpolating EWA Filters</a>'
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  -define filter:blur=.7071067811865475
  -define filter:c=.49257366
  -define filter:b=2.089813051319261
  -filter Cubic
</samp></pre>
                </td>
              </tr>
            </table>
          </div>When used to enlarge images. Pixels are converted into diamond like patterns in a scheme that is simular to <a href="../misc/#interpolate_simple">Blend</a> but using diamonds instead of squares. Any use of the expert options are at your own risk. They are not meant for production use, but as a method for exploring or producing tricky or otherwise impossible resize functions. Use at your own peril! <a name="summery" id="summery"></a>
          <h3>Summary of Resize Filters</h3>The following is my own personal view after studying, recoding, and documenting all the above filters available in ImageMagick. If you think I may be wrong or like to express your opinion, I invite you to express your views on the IM forum, and invite me to respond. <a href="#interpolated">Interpolation Filters</a>, such as '<code>Hermite</code>', are ideal when greatly enlarging images, producing a minimum of blur in the final result, though the output could often be artificially sharpened more in post-processing. <a href="#gaussian">Gaussian-like Blurring Filters</a>, such as '<code>Mitchell</code>', work best for images which basically consist of line drawings and cartoon like images. You can control the <a href="#blurring">blurring</a> versus the <a href="#aliasing">aliasing</a> effects of the filter on the image using the special <a href="#blur">Filter Blur Setting</a>. <a href="#windowed">Windowed Sinc/Jinc Filters</a>, and the <a href="#lagrange">Lagrange</a> equivalent are the best filters to use with real-world images, and especially when shrinking images. All of them are very similar in basic results. A larger support, or better still, lobe count setting, will generally produce an even better result, though you may get more <a href="#ringing">ringing</a> effects as well, but at a higher calculation cost. The <a href="#cubics">Cubic Filters</a> are a mixed bag of fast and simple filters, of fixed support (usually 2.0) which produces everything from the '<code>Hermite</code>' smooth interpolation filter, the qualitatively assessed '<code>Mitchell</code>' for image enlargements, the very blurry Gaussian-like '<code>Spline</code>' filter, or a sharp, windowed-sinc type of filter using '<code>Catrom</code>'. Generally if the resize results are acceptable as is, leave things alone, as you are more likely to make things worse, not better. <a name="compare" id="compare"></a>
          <h4>Filter Comparison</h4><i>Enlargement...</i>To give a final comparison, here I present a selection of 12 representative resize filters. The image is an enlargement of an aliased step in an one pixel wide line, on a dark gray background. The original image itself 'aliased' so you should be able to see how well various filters remove any existing aliasing effects.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick -size 10x6 xc:grey20 +antialias -draw 'fill white line 4,0 5,5' \
          -filter {<i>filter_type</i>} -resize 100x   {<i>result</i>}
</samp></pre>
                </td>
              </tr>
            </table><a href="montage_enlarge.png"><img src="montage_enlarge.png" align="middle" vspace="2" hspace="2" border="0" alt="[IM Output]"></a>
          </div>The above starts with the <a href="#interpolated">Interpolated Filters</a> and continues with the <a href="#gaussian">Gaussian Blurring Filters</a>, showing how much blurring these filters produce, and in doing so remove the 'aliasing' in the original image. No ringing is produced by these filters. The second line starts with three <a href="#windowed">Windowed Sinc Filters</a> showing the heavy ringing effects they can produce. Remember these filters are really designed for shrinking images, not enlarging. This continues into the '<code>Lagrange</code>' using its default 'interpolating' setting, and '<code>Catrom</code>' interpolated cubic filter. The final image is the '<code>Mitchell</code>' filter showing what the 'experts' subjectively agreed was the best 'ideal' filter to use for enlarging images, with a minimal of all four <a href="#artifacts">Resampling Artefacts</a> present in the final result. I myself agree with their findings, but only for enlargements. This is why '<code>Mitchell</code>' is the default 'enlargement' filter used by IM. <i>Shrinking...</i>To get an idea of the <a href="#aliasing">aliasing</a> effects, here I shrink the crop of <a href="../img_photos/rings_lg_orig.png">Large Rings Image</a> that we made earlier (<code>105x105</code> pixels in size), to see what sort of Moiré effects each of the same 12 representative filters generates.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick rings_crop.png -filter {<i>filter_type</i>} -resize 100x {<i>result</i>}
</samp></pre>
                </td>
              </tr>
            </table><a href="montage_shrink.png"><img src="montage_shrink.png" align="middle" vspace="2" hspace="2" border="0" alt="[IM Output]"></a>
          </div>As you can see <a href="#interpolated">Interpolated Filters</a> filters are very heavily aliased moiré effect, which is caused as a side-effect of the blocking artifacts these produce. On the other hand the blurring artifacts of the <a href="#gaussian">Gaussian Blurring Filters</a> removed all that blocking Moiré effects from the resulting image, though with a general blurring (indistinct lines) in the resulting image. The '<code><a href="#gaussian">Gaussian</a></code>' Filter itself does show a barely noticeable aliasing effect caused by its infinite (IIR) filter being clipped by the <a href="#support">Filter Support Setting</a>, but that is very minor. On the other hand the <a href="#windowed">Windowed Sinc Filters</a> produce a very sharp looking image with circular morié effects, of about equal intensity across all three representative filters. This is caused by the ringing artifacts these filters produce, generating interferance patterns. Finally the cubic filters also show some very light morié effects, but only due to negative lobe ringing. The '<code><a href="#mitchell">Mitchell</a></code>' filter, producing the least ringing effect. Note that '<code>Mitchell</code>' does generate very minor effects from almost all the resize artifacts. That is: grid-like moiré - aliasing/blocking, circular-like morié - ringing, and blurring of the lines. All the artifacts are however at very minimal levels, which is why it is a good all round filter. Here is another comparison, but this time heavily shrinking a <a href="../img_photos/rings_sm_orig.gif">Smaller Rings Image</a> smaller.
          <div align="center">
            <table class="table table-sm table-hover table-striped" cellspacing="0" cellpadding="5" width="90%" bgcolor="#F8F8F8">
              <tr>
                <td>
                  <pre class="bg-light text-dark mx-4"><samp>
  magick rings_sm_orig.gif -filter {<i>filter_type</i>} -resize 100x {<i>result</i>}
</samp></pre>
                </td>
              </tr>
            </table><a href="montage_smaller.png"><img src="montage_smaller.png" align="middle" vspace="2" hspace="2" border="0" alt="[IM Output]"></a>
          </div>As you can see the <a href="#interpolated">Interpolated Filters</a> produce lots of <a href="#aliasing">aliasing artifacts</a>, while the <a href="#gaussian">Gaussian Blurring Filters</a> tend to blur out more lines than the others. But all the other filters tend to produce a reasonable job. <a name="best_filter" id="best_filter"></a>
          <h4>The Best Filter?</h4>That is, something you will need to work out yourself. Often however it depends on what type of image and resizing you are doing. For enlarging images '<code>Mitchell</code>' is probably about the best filter you can use, while basically any of the <a href="#windowed">Windowed Filters</a> (default is '<code>Lanczos</code>') are good for shrinking images, especially when some type of low level pattern is involved. However if you have no patterns, but lots of straight edges (such as GIF transparency), you may be better off using sharpened <a href="#gaussian">Gaussian Filter</a> or again a '<code>Mitchell</code>', so as to avoid strong ringing effects. The '<code>Lagrange</code>' filter is also quite good, especially with a larger <a href="#support">Filter Support Setting</a>, for shrinking images. For those interested I recommend you look at the IM User Discussion topic <a href="../forum_link.cgi?f=1&amp;t=19425">a way to compare image quality after a resize?</a> which basically shows that their is no way of quantitatively determining "The Best Filter", only a qualitative or subjective "Best Filter". The choice is yours, and choice is a key feature of ImageMagick. <a name="default_filter" id="default_filter"></a>
          <h4>IM's Default Filter...</h4>It is for these reasons that '<code>Mitchell</code>' is the default filter for enlargement, as well as for shrinking images involving transparency, or images containing a Palette (or colormap). However the '<code>Lanczos</code>' will be used in all other cases, that is shrinking normal images (typically photographs). For <a href="../distorts/#distort">Distort</a>, the filter setting defaults to the '<code>Robidoux</code>' filter which was specifically designed to minimize image blurring when no actual distortion takes place. You can of course override these choices. <a name="nicolas" id="nicolas"></a>
          <h3>Nicolas Robidoux</h3>Nicolas Robidoux is an image processing expert with a lot more to say and recommend about trying to get the absolute best results from your image resizing. So much so he has his own section...<br>
          <a href="nicolas/">Resampling by Nicolas Robidoux</a>.
          <hr>
          <!-- ---------------------------------------------------------------- -->
        </div>
      </div>
    </div>
  </main>
  <footer class="magick-footer">
    <div class="container-fluid">
      Created: 10 October 2012 (split from resize)<br>
      Updated: 14 Feburary 2013<br>
      Author: <a href="https://antofthy.gitlab.io/anthony.html">Anthony Thyssen</a>, &lt;Anthony.Thyssen@gmail.com&gt;<br>
      Examples Generated with: <img src="version.gif" align="absmiddle" alt="[version image]"><br>
      URL: <code>https://imagemagick.org/Usage/filter/</code>
    </div>
  </footer>
</body>
</html>
